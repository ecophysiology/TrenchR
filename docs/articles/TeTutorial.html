<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TrenchR: Using energy balances to estimate body temperatures • TrenchR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TrenchR: Using energy balances to estimate body temperatures">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TrenchR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AllometryAndConversionsTutorial.html">TrenchR: Allometries and conversions</a>
    </li>
    <li>
      <a href="../articles/MicroclimateTutorial.html">TrenchR: Estimating microclimates</a>
    </li>
    <li>
      <a href="../articles/Symbols.html">List of Symbols</a>
    </li>
    <li>
      <a href="../articles/TeTutorial.html">TrenchR: Using energy balances to estimate body temperatures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/trenchproject/TrenchR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>TrenchR: Using energy balances to estimate body temperatures</h1>
                        <h4 class="author">Lauren Buckley and the TrEnCh project, Department of Biology, University of Washington</h4>
            
            <h4 class="date">2020-01-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/trenchproject/TrenchR/blob/master/vignettes/TeTutorial.Rmd"><code>vignettes/TeTutorial.Rmd</code></a></small>
      <div class="hidden name"><code>TeTutorial.Rmd</code></div>

    </div>

    
    
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Load TrenchR package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(TrenchR)</code></pre></div>
<p>This tutorial covers how to construct energy balances for applications such as estimating the body temperature of organisms. The tutorial first reviews general functions to estimate forms of heat exchange and balance the exchanges. Finally, we present functions to implement specialized energy balances for particular organisms.</p>
<div id="operative-environmental-temperatures" class="section level1">
<h1 class="hasAnchor">
<a href="#operative-environmental-temperatures" class="anchor"></a>Operative environmental temperatures</h1>
<p>The body temperatures, <span class="math inline">\(T_b\)</span>, of organisms can depart dramatically from air temperatures due to energy exchange with the environment. Heat is gained by absorbing solar and thermal radiation and from metabolic reactions. Heat is lost through the organism’s emission of radiation and the evaporation of water. The organism exchanges heat with the surrounding air or water via convection and with the ground and other solid surfaces in contact via conduction. The balance of these heat exchanges can be estimated and is referred to as operative environmental temperature, <span class="math inline">\(T_e\)</span>. The <span class="math inline">\(T_e\)</span> indicates the steady-state temperature of an organism with given physical properties in a particular environment <span class="citation">(G. S. Bakken 1992)</span>.</p>
<p>Calculations of operative environmental temperatures are based in balancing energy input and output to organisms. The following accounting of heat gains and losses at the surface of the organism can be used to estimate <span class="math inline">\(T_e\)</span> <span class="citation">(Gates 2012)</span>: <span class="math display">\[Qnet = Qabs - Qemit - Qconv - Qcond - Qmet - Qevap,\]</span> where <span class="math inline">\(Qnet\)</span> is the net energy exhange with the environment (W), <span class="math inline">\(Qabs\)</span> is the solar and thermal radiation absorbed (W), <span class="math inline">\(Qemit\)</span> is the thermal radiation emitted (W), <span class="math inline">\(Qconv\)</span> is energy exchange due to convection (W), <span class="math inline">\(Qcond\)</span> is energy exchange due to conduction (W), <span class="math inline">\(Qmet\)</span> is the energy emitted due to metabolism (W), and <span class="math inline">\(Qevap\)</span> is the energy emitted due to evaporative water loss (W).</p>
<p>The energy balance is available in TrenchR as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Qnet_Gates.html">Qnet_Gates</a></span>(<span class="dt">Qabs=</span><span class="dv">500</span>, <span class="dt">Qemit=</span><span class="dv">10</span>, <span class="dt">Qconv=</span><span class="dv">100</span>, <span class="dt">Qcond=</span><span class="dv">100</span>, <span class="dt">Qmet=</span><span class="dv">10</span>, <span class="dt">Qevap=</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 275</code></pre>
<p>We briefly review each component of the energy balance below. Details are available in biophysical ecology texts <span class="citation">(Gates 2012; Campbell and Norman 2012)</span>.</p>
</div>
<div id="solar-radiation-qabs" class="section level1">
<h1 class="hasAnchor">
<a href="#solar-radiation-qabs" class="anchor"></a>Solar radiation, Qabs</h1>
<p>The solar and thermal radiation absorbed by animals, <span class="math inline">\(Q_{abs} (W)\)</span>, is the sum of direct <span class="math inline">\(S_{dir}\)</span>, diffuse <span class="math inline">\(S_{dif}\)</span>, and reflected <span class="math inline">\(S_{ref}\)</span> solar radiation (<span class="math inline">\(W/m^2\)</span>). The sum is weighted by the organism’s surface area <span class="math inline">\(A\)</span> exposed to the radiation sources. Additionally, all forms of incoming radiation are multipled by the solar absorptivity of the animal surface (<span class="math inline">\(a\)</span> proportion) to estimate absorbed radiation. The sumation of incoming solar radiation is thus as follows: <span class="math display">\[Qabs= a*A_{dir}*S_{dir} + a*A_{dif}*S_{dif} + a*A_{ref}*S_{ref},\]</span> where <span class="math inline">\(A_{dir}\)</span>, <span class="math inline">\(A_{dif}\)</span>, and <span class="math inline">\(A_{ref}\)</span> are the surface areas expsed to direct, diffuse, and reflected solar radiation, respectively.</p>
<p>The summation is available in R as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">100</span>), <span class="kw"><a href="../reference/Qradiation_absorbed.html">Qradiation_absorbed</a></span>(<span class="dt">a=</span><span class="fl">0.9</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.4</span>, <span class="dt">psa_ref=</span><span class="fl">0.4</span>, <span class="dt">S_dir=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">100</span>), <span class="dt">S_dif=</span><span class="dv">200</span>, <span class="dt">a_s=</span><span class="fl">0.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"direct solar radiation"</span> <span class="op">~</span><span class="st"> </span>(W<span class="op">/</span>m<span class="op">^</span>{<span class="dv">2</span>})), <span class="dt">ylab =</span> <span class="st">"solar radiation absorbed (W)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">100</span>), <span class="kw"><a href="../reference/Qradiation_absorbed.html">Qradiation_absorbed</a></span>(<span class="dt">a=</span><span class="fl">0.9</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.2</span>, <span class="dt">psa_ref=</span><span class="fl">0.4</span>, <span class="dt">S_dir=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">100</span>), <span class="dt">S_dif=</span><span class="dv">200</span>, <span class="dt">a_s=</span><span class="fl">0.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">100</span>), <span class="kw"><a href="../reference/Qradiation_absorbed.html">Qradiation_absorbed</a></span>(<span class="dt">a=</span><span class="fl">0.45</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.4</span>, <span class="dt">psa_ref=</span><span class="fl">0.4</span>, <span class="dt">S_dir=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">100</span>), <span class="dt">S_dif=</span><span class="dv">200</span>, <span class="dt">a_s=</span><span class="fl">0.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">100</span>), <span class="kw"><a href="../reference/Qradiation_absorbed.html">Qradiation_absorbed</a></span>(<span class="dt">a=</span><span class="fl">0.9</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.4</span>, <span class="dt">psa_ref=</span><span class="fl">0.4</span>, <span class="dt">S_dir=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">100</span>), <span class="dt">S_dif=</span><span class="dv">200</span>, <span class="dt">a_s=</span><span class="fl">0.2</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a=0.9, psa_dir=0.4, a_s=0.5"</span>, <span class="st">"a=0.9, psa_dir=0.2, a_s=0.5"</span>, <span class="st">"a=0.45, psa_dir=0.4, a_s=0.5"</span>, <span class="st">"a=0.9, psa_dir=0.4, a_s=0.2"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>In the functions, psa_dir and psa_ref are the proportions of surface area exposed to direct and reflected solar radiation, respectively. We assume psa_dif = psa_dir. The functions <code><a href="../reference/prop_silhouette_area.html">prop_silhouette_area()</a></code> and <code><a href="../reference/prop_silhouette_area_shapes.html">prop_silhouette_area_shapes()</a></code> provide assistance calculating the proportional of surface area exposed via estimating silhouette area. Additionally, see the microclimate tutorial for tools for estimating incoming solar radiation.</p>
</div>
<div id="thermal-radiation-qemit" class="section level1">
<h1 class="hasAnchor">
<a href="#thermal-radiation-qemit" class="anchor"></a>Thermal radiation, Qemit</h1>
<p>The rate of emission of thermal radiation from the surface of an animal, <span class="math inline">\(Q_{emit} (W)\)</span>, is determined by the difference between the surface temperature of the animal <span class="math inline">\(T_b (K)\)</span> and the temperatures of the air <span class="math inline">\(T_a (K)\)</span> and of the ground <span class="math inline">\(T_g (K)\)</span>. <span class="math inline">\(T_a\)</span> is additionally used to estimate sky temperature <span class="math inline">\(T_{sky} (K)\)</span>, the effective radiant temperature of the sky as <span class="math inline">\(T_{sky}=1.22*(T_a-273.15)-20.4+273.15\)</span> <span class="citation">(Gates 2012)</span>. The following expressions can be used to estimate <span class="math inline">\(Q_{emit} (W)\)</span> for animals in enclosed and open environments, respectively: <span class="math display">\[
enclosed: Q_{emit}= A_r \epsilon \sigma (T_b^4 - T_a^4)\\
open: Q_{emit}= \epsilon \sigma (A_s (T_b^4 - T_{sky}^4)+A_r (T_b^4 - T_g^4)),
\]</span> where <span class="math inline">\(A_s\)</span> and <span class="math inline">\(A_r\)</span> are the areas (<span class="math inline">\(m^2\)</span>) exposed to the sky (or enclosure) and the ground, respectively; <span class="math inline">\(\epsilon\)</span> is the longwave infrared emissivity of skin [proportion, 0.95 to 1 for most animals <span class="citation">(Gates 2012)</span>; and <span class="math inline">\(\sigma\)</span> is the Stefan-Boltzmann constant (<span class="math inline">\(5.673*10^{-8} W m^{-2} K^{-4}\)</span>).</p>
<p>The function is available in R as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qemitted_thermal_radiation.html">Qemitted_thermal_radiation</a></span>(<span class="dt">epsilon=</span><span class="fl">0.96</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.4</span>, <span class="dt">psa_ref=</span><span class="fl">0.6</span>, <span class="dt">T_b=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">T_g=</span><span class="dv">293</span>, <span class="dt">T_a=</span><span class="dv">298</span>, <span class="dt">enclosed=</span><span class="ot">FALSE</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"body surface temperature, Tb (K)"</span>, <span class="dt">ylab =</span> <span class="st">"emitted thermal radiation, Qemit (W)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qemitted_thermal_radiation.html">Qemitted_thermal_radiation</a></span>(<span class="dt">epsilon=</span><span class="fl">0.96</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.2</span>, <span class="dt">psa_ref=</span><span class="fl">0.8</span>, <span class="dt">T_b=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">T_g=</span><span class="dv">293</span>, <span class="dt">T_a=</span><span class="dv">298</span>, <span class="dt">enclosed=</span><span class="ot">TRUE</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qemitted_thermal_radiation.html">Qemitted_thermal_radiation</a></span>(<span class="dt">epsilon=</span><span class="fl">0.96</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.4</span>, <span class="dt">psa_ref=</span><span class="fl">0.8</span>, <span class="dt">T_b=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">T_g=</span><span class="dv">283</span>, <span class="dt">T_a=</span><span class="dv">298</span>, <span class="dt">enclosed=</span><span class="ot">FALSE</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qemitted_thermal_radiation.html">Qemitted_thermal_radiation</a></span>(<span class="dt">epsilon=</span><span class="fl">0.96</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.2</span>, <span class="dt">psa_ref=</span><span class="fl">0.6</span>, <span class="dt">T_b=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">T_g=</span><span class="dv">283</span>, <span class="dt">T_a=</span><span class="dv">298</span>, <span class="dt">enclosed=</span><span class="ot">FALSE</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"psa_dir=0.4, T_g=293"</span>,<span class="st">"psa_dir=0.2, T_g=293"</span>,<span class="st">"psa_dir=0.4, T_g=283"</span>,<span class="st">"psa_dir=0.2, T_g=283"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
</div>
<div id="convection-qconv" class="section level1">
<h1 class="hasAnchor">
<a href="#convection-qconv" class="anchor"></a>Convection, Qconv</h1>
<p>Animals exchange heat with the air or water they are immersed in at a rate determined by the temperature difference between the temperature of the animal, <span class="math inline">\(T_b (K)\)</span>, and that of the air or water, <span class="math inline">\(T_a (K)\)</span>. The rate is also determined by the animal’s surface area exposed to the air or water, which we estimate from the input parameters of the animal’s surface area, <span class="math inline">\(A (m^2)\)</span> and the proportion of the surface area in contact with the surrounding fluid, <span class="math inline">\(proportion\)</span>. A heat transfer coefficient, <span class="math inline">\(H_L (W m^{-2} K^{-1})\)</span>, which can be estimated using the relations below, is used to estimate the rate of heat exchange. An enhancement factor multiplier, <span class="math inline">\(ef\)</span>, can also be incorporated to account for increases in heat exchange resulting from air turbulance in field conditions. Conduction can be estimated as follows: <span class="math display">\[Qconv= ef*H_L*(A*proportion)*(Ta-Tb).\]</span></p>
<p>The function is available in R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconvection.html">Qconvection</a></span>(<span class="dt">T_a=</span> <span class="dv">303</span>,<span class="dt">T_b=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">H=</span><span class="dv">5</span>,<span class="dt">A=</span><span class="fl">0.0025</span>, <span class="dt">proportion=</span><span class="fl">0.6</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ground temperature (K)"</span>, <span class="dt">ylab =</span> <span class="st">"Q convection (W)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconvection.html">Qconvection</a></span>(<span class="dt">T_a=</span> <span class="dv">303</span>,<span class="dt">T_b=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">H=</span><span class="dv">15</span>,<span class="dt">A=</span><span class="fl">0.0025</span>, <span class="dt">proportion=</span><span class="fl">0.6</span>), <span class="dt">type=</span><span class="st">"l"</span>,<span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconvection.html">Qconvection</a></span>(<span class="dt">T_a=</span> <span class="dv">303</span>,<span class="dt">T_b=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">H=</span><span class="dv">5</span>,<span class="dt">A=</span><span class="fl">0.0025</span>, <span class="dt">proportion=</span><span class="fl">0.3</span>), <span class="dt">type=</span><span class="st">"l"</span>,<span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconvection.html">Qconvection</a></span>(<span class="dt">T_a=</span> <span class="dv">303</span>,<span class="dt">T_b=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">H=</span><span class="dv">15</span>,<span class="dt">A=</span><span class="fl">0.0025</span>, <span class="dt">proportion=</span><span class="fl">0.3</span>), <span class="dt">type=</span><span class="st">"l"</span>,<span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"H=5, proportion=0.6"</span>,<span class="st">"H=15, proportion=0.6"</span>,<span class="st">"H=5, proportion=0.3"</span>,<span class="st">"H=15, proportion=0.3"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>The convective heat transfer coefficient depends on whether the heat exchange is free or forced (due to fluid flow). The variables involved in heat transfer can be combined into dimensionless groups that are used to compare the scales of heat exchange processes and thus whether modeling free or forced convection is more appropriate. We provide the primary dimesionless numbers.</p>
<p>The Nusselt number provides a dimensionless estimate of conductance as is estimated as <span class="math inline">\(Nu = H_L * D / K\)</span>, where <span class="math inline">\(H_L\)</span> is the convective heat transfer coefficient (<span class="math inline">\(W m^{-2} K^{-1}\)</span>), <span class="math inline">\(D\)</span> is the characteristic dimension (<span class="math inline">\(m\)</span>), and <span class="math inline">\(K\)</span> is thermal conductivity (<span class="math inline">\(W K^{-1}m^{-1}\)</span>).</p>
<p>The Prandtl number describes the ratio of kinematic viscosity to thermal diffusivity as <span class="math inline">\(Pr= c_p \mu /K\)</span>, where <span class="math inline">\(c_p\)</span> is the specific heat at constant pressure (<span class="math inline">\(J mol^{-1} K^{-1}\)</span>) and <span class="math inline">\(\mu\)</span> is dynamic viscosity (<span class="math inline">\(mol \:s^{-1}m^{-1}\)</span>).</p>
<p>The Reynolds Number indicates the amount of turbulence in air or water flows and is estimated as the ratio of internal viscous forces: <span class="math inline">\(Re= VD / \nu\)</span>, where <span class="math inline">\(V\)</span> is wind speed (<span class="math inline">\(m/s\)</span>), <span class="math inline">\(D\)</span> is the characteristic dimension (<span class="math inline">\(m\)</span>), and <span class="math inline">\(\nu\)</span> is the kinematic viscosity (<span class="math inline">\(m^2 s^{-1}\)</span>). Kinematic viscosity is the ratio of dynamic viscosity to the density of the fluid.</p>
<p>The Grashof number describes the abilty of a parcel of fluid warmer or colder than the surrounding fluid to rise against or fall with the attractive force of gravity. It is estimated as the ratio of a buoyant force times an inertial force to the square of a viscous force: <span class="math inline">\(Gr = g D^3 \frac{\mid Tg-Ta \mid}{Ta {\nu}^2}\)</span>, where <span class="math inline">\(g\)</span> is gravitational acceleration (<span class="math inline">\(g=9.8 m/s\)</span>).</p>
<p>The dimensionless groups are available in R as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/Nusselt_number.html">Nusselt_number</a></span>(<span class="dt">H_L=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">D=</span><span class="fl">0.01</span>, <span class="dt">K=</span><span class="fl">0.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"heat transfer coefficient"</span> <span class="op">~</span><span class="st"> </span>(W <span class="op">~</span><span class="st"> </span>m<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>} <span class="op">~</span><span class="st"> </span>K<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})), <span class="dt">ylab =</span> <span class="st">"Nusselt number"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/Nusselt_number.html">Nusselt_number</a></span>(<span class="dt">H_L=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">D=</span><span class="fl">0.01</span>, <span class="dt">K=</span><span class="fl">1.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/Nusselt_number.html">Nusselt_number</a></span>(<span class="dt">H_L=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">D=</span><span class="fl">0.05</span>, <span class="dt">K=</span><span class="fl">0.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/Nusselt_number.html">Nusselt_number</a></span>(<span class="dt">H_L=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">D=</span><span class="fl">0.05</span>, <span class="dt">K=</span><span class="fl">1.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"D=0.01, K=0.5"</span>,<span class="st">"D=0.01, K=1.5"</span>,<span class="st">"D=0.05, K=0.5"</span>,<span class="st">"D=0.05, K=1.5"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/Prandtl_number.html">Prandtl_number</a></span>(<span class="dt">c_p=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">mu=</span><span class="fl">0.00001</span>, <span class="dt">K=</span><span class="fl">0.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"specific heat at constant pressure"</span> <span class="op">~</span><span class="st"> </span>(J <span class="op">~</span><span class="st"> </span>mol<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>} <span class="op">~</span><span class="st"> </span>K<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})), <span class="dt">ylab =</span> <span class="st">"Prandtl number"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/Prandtl_number.html">Prandtl_number</a></span>(<span class="dt">c_p=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">mu=</span><span class="fl">0.00002</span>, <span class="dt">K=</span><span class="fl">0.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/Prandtl_number.html">Prandtl_number</a></span>(<span class="dt">c_p=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">mu=</span><span class="fl">0.00001</span>, <span class="dt">K=</span><span class="fl">1.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/Prandtl_number.html">Prandtl_number</a></span>(<span class="dt">c_p=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">mu=</span><span class="fl">0.00002</span>, <span class="dt">K=</span><span class="fl">1.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mu=0.00001, K=0.5"</span>,<span class="st">"mu=0.00002, K=0.5"</span>,<span class="st">"mu=0.00001, K=1.5"</span>,<span class="st">"mu=0.00002, K=1.5"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.2</span>), <span class="kw"><a href="../reference/Reynolds_number.html">Reynolds_number</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.2</span>), <span class="dt">D=</span><span class="fl">0.001</span>, <span class="dt">nu=</span><span class="dv">1</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"wind speed (m/s)"</span>, <span class="dt">ylab =</span> <span class="st">"Reynolds number"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.2</span>), <span class="kw"><a href="../reference/Reynolds_number.html">Reynolds_number</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.2</span>), <span class="dt">D=</span><span class="fl">0.001</span>, <span class="dt">nu=</span><span class="fl">1.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.2</span>), <span class="kw"><a href="../reference/Reynolds_number.html">Reynolds_number</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.2</span>), <span class="dt">D=</span><span class="fl">0.002</span>, <span class="dt">nu=</span><span class="dv">1</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.2</span>), <span class="kw"><a href="../reference/Reynolds_number.html">Reynolds_number</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.2</span>), <span class="dt">D=</span><span class="fl">0.002</span>, <span class="dt">nu=</span><span class="fl">1.5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"D=0.001, nu=1"</span>,<span class="st">"D=0.001, nu=1.5"</span>,<span class="st">"D=0.002, nu=1"</span>,<span class="st">"D=0.002, nu=1.5"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>), <span class="kw"><a href="../reference/Grashof_number.html">Grashof_number</a></span>(<span class="dt">Ta=</span><span class="dv">30</span>, <span class="dt">Tg=</span><span class="dv">35</span>, <span class="dt">D=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>), <span class="dt">nu=</span><span class="fl">1.0</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"characteristic dimension (m)"</span>, <span class="dt">ylab =</span> <span class="st">"Grashof number"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>), <span class="kw"><a href="../reference/Grashof_number_Gates.html">Grashof_number_Gates</a></span>(<span class="dt">Ta=</span><span class="dv">30</span>, <span class="dt">Tg=</span><span class="dv">35</span>, <span class="dt">beta=</span><span class="fl">0.00367</span>, <span class="dt">D=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>), <span class="dt">nu=</span><span class="fl">1.0</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">col=</span><span class="st">"red"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>), <span class="kw"><a href="../reference/Grashof_number.html">Grashof_number</a></span>(<span class="dt">Ta=</span><span class="dv">30</span>, <span class="dt">Tg=</span><span class="dv">35</span>, <span class="dt">D=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>), <span class="dt">nu=</span><span class="fl">1.4</span>), <span class="dt">type=</span><span class="st">"l"</span>,<span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>), <span class="kw"><a href="../reference/Grashof_number_Gates.html">Grashof_number_Gates</a></span>(<span class="dt">Ta=</span><span class="dv">30</span>, <span class="dt">Tg=</span><span class="dv">35</span>, <span class="dt">beta=</span><span class="fl">0.00367</span>, <span class="dt">D=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>), <span class="dt">nu=</span><span class="fl">1.4</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">col=</span><span class="st">"red"</span>,<span class="dt">lty=</span><span class="st">"dashed"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Grashof_number, nu=1"</span>,<span class="st">"Grashof_number_Gates, nu=1"</span>,<span class="st">"Grashof_number, nu=1.4"</span>,<span class="st">"Grashof_number_Gates, nu=1.4"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#WHY DIFFERENT BETWEEN BOOKS?</span></code></pre></div>
<p>Relations among the dimensionless groups can also be used for estimation. Empirically-derived relationships can be used to estimate the Nusselt number <span class="math inline">\(Nu\)</span> from the Reynolds number <span class="math inline">\(Re\)</span> or the Grashof number <span class="math inline">\(Gr\)</span>. Comparisons of <span class="math inline">\(Gr\)</span> and <span class="math inline">\(Re\)</span> allow determining whether modelling free or forced convection is appropraite. Forced convection is appropriate when <span class="math inline">\(Gr \leq 16 Re^2\)</span>. For convenience, we provide the relationships as R functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"sphere"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"Re"</span>, <span class="dt">ylab =</span> <span class="st">"Nu"</span>, <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">4</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"cylinder"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"frog"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"lizard_traverse_to_air_flow"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"lizard_parallel_to_air_flow"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>, <span class="dt">col=</span><span class="st">"red"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"lizard_surface"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>, <span class="dt">col=</span><span class="st">"orange"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"lizard_elevated"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>, <span class="dt">col=</span><span class="st">"green"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"flyinginsect"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"longdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw"><a href="../reference/Nu_from_Re.html">Nu_from_Re</a></span>(<span class="dt">Re=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">taxa=</span><span class="st">"spider"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"twodash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="dt">title=</span><span class="st">"taxa"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sphere"</span>,<span class="st">"cylinder"</span>,<span class="st">"frog"</span>,<span class="st">"lizard_traverse_to_air_flow"</span>,<span class="st">"lizard_parallel_to_air_flow"</span>,<span class="st">"lizard_surface"</span>,<span class="st">"lizard_elevated"</span>,<span class="st">"flyinginsect"</span>,<span class="st">"spider"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>,<span class="st">"dotdash"</span>,<span class="st">"dotdash"</span>,<span class="st">"dotdash"</span>,<span class="st">"longdash"</span>,<span class="st">"twodash"</span>), <span class="dt">col=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"black"</span>,<span class="st">"black"</span>,<span class="st">"black"</span>,<span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"orange"</span>,<span class="st">"green"</span>,<span class="st">"black"</span>,<span class="st">"black"</span> ) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Nu_from_Gr.html">Nu_from_Gr</a></span>(<span class="dt">Gr=</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 0.7177674</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Free_or_forced_convection.html">Free_or_forced_convection</a></span>(<span class="dt">Gr=</span><span class="dv">100</span>, <span class="dt">Re=</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] "intermediate condition, mixed convection based on Nusselt numerbers is appropriate"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Free_or_forced_convection.html">Free_or_forced_convection</a></span>(<span class="dt">Gr=</span><span class="dv">1</span>, <span class="dt">Re=</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] "forced convection"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Free_or_forced_convection.html">Free_or_forced_convection</a></span>(<span class="dt">Gr=</span><span class="dv">1000</span>, <span class="dt">Re=</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] "free convection"</code></pre>
<p>We offer methods to estimate the convective heat transfer coefficient based on either empirical measurements (<code><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient()</a></code>) or approximating the animal shape as a sphere (<code><a href="../reference/heat_transfer_coefficient_approximation.html">heat_transfer_coefficient_approximation()</a></code>). Approximating the animal shape as a sphere enables simplification while also producing an reasonable approximation <span class="citation">(J. W. Mitchell 1976)</span>. The functions approximate forced convective heat transfer as a function of windspeed <span class="math inline">\(V (m/s)\)</span>, the characteristic dimension <span class="math inline">\(D (m)\)</span>, the thermal conductivity of the air <span class="math inline">\(K (W m^{-1} K^{-1})\)</span>, the kinematic viscocity of the air <span class="math inline">\(\nu (m^2 s^{-1})\)</span>, and the taxa or a generic shape. An additional, simplified function (<code><a href="../reference/heat_transfer_coefficient_simple.html">heat_transfer_coefficient_simple()</a></code>) provides a reasonable approximation based on <span class="math inline">\(V\)</span> and <span class="math inline">\(D\)</span> for most environmental conditions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"sphere"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"Air velocity (m/s)"</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"heat transfer coefficient,"</span> <span class="op">~</span><span class="st"> </span>H[L] <span class="op">~</span><span class="st"> </span>(W <span class="op">~</span><span class="st"> </span>m<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>} <span class="op">~</span><span class="st"> </span>K<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"cylinder"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"frog"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"lizard_surface"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"lizard_elevated"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"flyinginsect"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"longdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"spider"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"twodash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>, <span class="dt">title=</span><span class="st">"taxa"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sphere"</span>,<span class="st">"cylinder"</span>,<span class="st">"frog"</span>,<span class="st">"lizard_surface"</span>,<span class="st">"lizard_elevated"</span>,<span class="st">"flyinginsect"</span>,<span class="st">"spider"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>,<span class="st">"dotdash"</span>,<span class="st">"dotdash"</span>,<span class="st">"dotdash"</span>,<span class="st">"longdash"</span>,<span class="st">"twodash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient_approximation.html">heat_transfer_coefficient_approximation</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"sphere"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"Air velocity (m/s)"</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"heat transfer coefficient,"</span> <span class="op">~</span><span class="st"> </span>H[L] <span class="op">~</span><span class="st"> </span>(W <span class="op">~</span><span class="st"> </span>m<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>} <span class="op">~</span><span class="st"> </span>K<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient_approximation.html">heat_transfer_coefficient_approximation</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"frog"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient_approximation.html">heat_transfer_coefficient_approximation</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"lizard"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient_approximation.html">heat_transfer_coefficient_approximation</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"flyinginsect"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient_approximation.html">heat_transfer_coefficient_approximation</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>,<span class="dt">K=</span> <span class="fl">25.7</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="st">"spider"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"longdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>, <span class="dt">title=</span><span class="st">"taxa"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sphere"</span>,<span class="st">"frog"</span>,<span class="st">"lizard"</span>,<span class="st">"flyinginsect"</span>,<span class="st">"spider"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>,<span class="st">"longdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient_simple.html">heat_transfer_coefficient_simple</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.05</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"Air velocity (m/s)"</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"heat transfer coefficient,"</span> <span class="op">~</span><span class="st"> </span>H[L] <span class="op">~</span><span class="st"> </span>(W <span class="op">~</span><span class="st"> </span>m<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>} <span class="op">~</span><span class="st"> </span>K<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient_simple.html">heat_transfer_coefficient_simple</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.03</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>), <span class="kw"><a href="../reference/heat_transfer_coefficient_simple.html">heat_transfer_coefficient_simple</a></span>(<span class="dt">V=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dt">D=</span><span class="fl">0.07</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>, <span class="dt">title=</span><span class="st">"characteristic dimension (m)"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.07</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>,<span class="st">"solid"</span>,<span class="st">"dotted"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
</div>
<div id="conduction-qcond" class="section level1">
<h1 class="hasAnchor">
<a href="#conduction-qcond" class="anchor"></a>Conduction, Qcond</h1>
<p>Animals exchange heat with the substrate and other surfaces via contact proportional to the difference between the surface temperature of the animal, <span class="math inline">\(T_b (K)\)</span>, and the substrate temperature, <span class="math inline">\(T_s (K)\)</span>. This conduction occurs via diffusion of heat. The extent of energy exchange is additionally determined by the area of contact and the thickness of the skin or other animal suface (assumes a well mixed interior, see NicheMapR for approaches without this assumption). Finally, the rate of diffusion depends on the thermal conductivity of the materials in contact. Our two basic functions for estimating conduction differ in whether the rate limiting step is the thermal conductivity of the animal [<code>conductance_animal()</code>] or the substrate [<code>conductance_substrate()</code>]. The thermal conductivity of the ground is generally greater than that of animal tissues, so animal thermal conductivity is generally the rate limiting step and most applications should use <code>conductance_animal()</code>.</p>
<p>Both variables take as parameters the animal’s surface area, <span class="math inline">\(A (m^2)\)</span>, and the proportion of the surface area in contact with the substrate, <span class="math inline">\(proportion\)</span>.</p>
<p>When animal conductance is the rate limiting step, <span class="math inline">\(Qcond\)</span> can be estimated as follows: <span class="math display">\[Qcond= A*proportion*K*(T_b-T_g)/d, \]</span> where <span class="math inline">\(K\)</span> is thermal conductivity (<span class="math inline">\(W K^{-1} m^{-1}\)</span>), <span class="math inline">\(T_g\)</span> is ground (surface) temperature <span class="math inline">\((K)\)</span>, <span class="math inline">\(T_b\)</span> is body temperature <span class="math inline">\((K)\)</span>, and <span class="math inline">\(d\)</span> is the mean thickness of the animal skin (surface, <span class="math inline">\(m\)</span>). This formulation assumes the organism has a well mixed interior rather than an interior temperature gradient.</p>
<p>When substrate thermal conductivity is the rate limiting step, <span class="math inline">\(Qcond\)</span> can be estimated as follows: <span class="math display">\[Qcond= A*proportion*(2K_g/D)*(T_b-T_g),\]</span> where <span class="math inline">\(K_g\)</span> is the thermal conductivity of substrate (<span class="math inline">\(W K^{-1} m^{-1}\)</span>) and <span class="math inline">\(D\)</span> is the characteristic dimension of the animal (<span class="math inline">\(m\)</span>).</p>
<p>The functions are available in R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconduction_animal.html">Qconduction_animal</a></span>(<span class="dt">T_g=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">T_b=</span><span class="dv">303</span>,<span class="dt">d=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>,<span class="dt">K=</span><span class="fl">0.3</span>,<span class="dt">A=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>, <span class="dt">proportion=</span><span class="fl">0.2</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ground temperature (K)"</span>, <span class="dt">ylab =</span> <span class="st">"Q conductance (W)"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconduction_animal.html">Qconduction_animal</a></span>(<span class="dt">T_g=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">T_b=</span><span class="dv">303</span>,<span class="dt">d=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>,<span class="dt">K=</span><span class="fl">0.5</span>,<span class="dt">A=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>, <span class="dt">proportion=</span><span class="fl">0.2</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconduction_animal.html">Qconduction_animal</a></span>(<span class="dt">T_g=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">T_b=</span><span class="dv">303</span>,<span class="dt">d=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>,<span class="dt">K=</span><span class="fl">0.3</span>,<span class="dt">A=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>, <span class="dt">proportion=</span><span class="fl">0.4</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconduction_animal.html">Qconduction_animal</a></span>(<span class="dt">T_g=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">T_b=</span><span class="dv">303</span>,<span class="dt">d=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>,<span class="dt">K=</span><span class="fl">0.5</span>,<span class="dt">A=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>, <span class="dt">proportion=</span><span class="fl">0.4</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"K=0.3, proportion=0.2"</span>,<span class="st">"K=0.5, proportion=0.2"</span>,<span class="st">"K=0.3, proportion=0.4"</span>,<span class="st">"K=0.5, proportion=0.4"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconduction_substrate.html">Qconduction_substrate</a></span>(<span class="dt">T_g=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">T_b=</span><span class="dv">303</span>,<span class="dt">D=</span><span class="fl">0.01</span>,<span class="dt">K_g=</span><span class="fl">0.3</span>,<span class="dt">A=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">2</span>, <span class="dt">proportion=</span><span class="fl">0.2</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ground temperature (K)"</span>, <span class="dt">ylab =</span> <span class="st">"Q conductance (W)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconduction_substrate.html">Qconduction_substrate</a></span>(<span class="dt">T_g=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">T_b=</span><span class="dv">303</span>,<span class="dt">D=</span><span class="fl">0.01</span>,<span class="dt">K_g=</span><span class="fl">0.5</span>,<span class="dt">A=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">2</span>, <span class="dt">proportion=</span><span class="fl">0.2</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconduction_substrate.html">Qconduction_substrate</a></span>(<span class="dt">T_g=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">T_b=</span><span class="dv">303</span>,<span class="dt">D=</span><span class="fl">0.01</span>,<span class="dt">K_g=</span><span class="fl">0.3</span>,<span class="dt">A=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">2</span>, <span class="dt">proportion=</span><span class="fl">0.4</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qconduction_substrate.html">Qconduction_substrate</a></span>(<span class="dt">T_g=</span> <span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="dt">T_b=</span><span class="dv">303</span>,<span class="dt">D=</span><span class="fl">0.01</span>,<span class="dt">K_g=</span><span class="fl">0.5</span>,<span class="dt">A=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">2</span>, <span class="dt">proportion=</span><span class="fl">0.4</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"K=0.3, proportion=0.2"</span>,<span class="st">"K=0.5, proportion=0.2"</span>,<span class="st">"K=0.3, proportion=0.4"</span>,<span class="st">"K=0.5, proportion=0.4"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
</div>
<div id="metabolism-qmet" class="section level1">
<h1 class="hasAnchor">
<a href="#metabolism-qmet" class="anchor"></a>Metabolism, Qmet</h1>
<p>Rates of heat production associated with metabolism are generally estimated using scaling relationships based on generalizing empirical data. Metabolic rates scale as a power law function of mass with an exponent less than 1 such that the per-mass metabolic rate declines with increasing mass. Metabolic rates also increase exponentially with temperature. The generally form of the relationship is <span class="math inline">\(B=M^x \exp(-E_i/{kT})\)</span>, where <span class="math inline">\(M\)</span> is mass, <span class="math inline">\(x\)</span> is an exponent approximating 0.75, <span class="math inline">\(E_i\)</span> is the average activation energy for the rate-limiting enzyme-catalyzed biochemical reactions of metabolism, <span class="math inline">\(k\)</span> is the Boltzmann constant, and <span class="math inline">\(T\)</span> is body temperature <span class="citation">(Gillooly et al. 2001)</span>. We offer functions that both do not [<code><a href="../reference/Qmetabolism_from_mass.html">Qmetabolism_from_mass()</a></code>] and do [<code><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp()</a></code>] include temperature dependence for a variety of taxa.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass.html">Qmetabolism_from_mass</a></span>(<span class="dt">m=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="st">"bird"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"mass (g)"</span>, <span class="dt">ylab =</span> <span class="st">"metabolism (W)"</span>, <span class="dt">log=</span><span class="st">'xy'</span>, <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass.html">Qmetabolism_from_mass</a></span>(<span class="dt">m=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="st">"mammal"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass.html">Qmetabolism_from_mass</a></span>(<span class="dt">m=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="st">"reptile"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"taxa"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bird"</span>,<span class="st">"mammal"</span>,<span class="st">"reptile"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp</a></span>(<span class="dt">m=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">T_b=</span><span class="dv">303</span>,<span class="st">"bird"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"mass (g)"</span>, <span class="dt">ylab =</span> <span class="st">"metabolism (W)"</span>, <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="fl">0.1</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp</a></span>(<span class="dt">m=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">T_b=</span><span class="dv">303</span>,<span class="st">"reptile"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp</a></span>(<span class="dt">m=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">T_b=</span><span class="dv">303</span>,<span class="st">"amphibian"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp</a></span>(<span class="dt">m=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">T_b=</span><span class="dv">303</span>,<span class="st">"invertebrate"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"twodash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"top"</span>, <span class="dt">title=</span><span class="st">"taxa"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bird,mammal"</span>,<span class="st">"reptile"</span>,<span class="st">"amphibian"</span>,<span class="st">"invertebrate"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>,<span class="st">"twodash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-19-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp</a></span>(<span class="dt">m=</span><span class="dv">5</span>, <span class="dt">T_b=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="st">"bird"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"temperature (K)"</span>, <span class="dt">ylab =</span> <span class="st">"metabolism (W)"</span>, <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="fl">0.1</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp</a></span>(<span class="dt">m=</span><span class="dv">5</span>, <span class="dt">T_b=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="st">"reptile"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp</a></span>(<span class="dt">m=</span><span class="dv">5</span>, <span class="dt">T_b=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="st">"amphibian"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Qmetabolism_from_mass_temp.html">Qmetabolism_from_mass_temp</a></span>(<span class="dt">m=</span><span class="dv">5</span>, <span class="dt">T_b=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>,<span class="st">"invertebrate"</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"twodash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">title=</span><span class="st">"taxa"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bird,mammal"</span>,<span class="st">"reptile"</span>,<span class="st">"amphibian"</span>,<span class="st">"invertebrate"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>,<span class="st">"twodash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-19-2.png" width="576"></p>
</div>
<div id="evaporation-qevap" class="section level1">
<h1 class="hasAnchor">
<a href="#evaporation-qevap" class="anchor"></a>Evaporation, Qevap</h1>
<p>We provide functions to estimate heat loss associated with evaporative water loss. We offer an empirically-derived relationship for a lizard <span class="citation">(W. Porter et al. 1973; in Gates 2012)</span> and a function based on resistances for amphibians <span class="citation">(Spotila, O’connor, and Bakken 1992)</span>. The function for amphibians is based on the latent heat of vaporization of water: evaporation of water results in heat loss at a rate of <span class="math inline">\(2.44 \times 10^6 J kg^{-1}\)</span> at biological temperatures.</p>
<p>The rate of water loss for an amphibian with fully wetted skin can be expressed as <span class="math display">\[ E_c= A (\rho_s-h \rho_a)/r_e,\]</span></p>
<p>where <span class="math inline">\(A\)</span> is surface area (<span class="math inline">\(m^2\)</span>), <span class="math inline">\(r_e\)</span> is the external (convective) resistance to water vapor transport (<span class="math inline">\(s/m\)</span>), <span class="math inline">\(\rho_s\)</span> is the saturation water vapor density at skin surface (<span class="math inline">\(kg/m^3\)</span>), <span class="math inline">\(h\)</span> is relative humidity (between 0 ~ 1), and <span class="math inline">\(\rho_a\)</span> is the saturation water vapor density in ambient air (<span class="math inline">\(kg/m^3\)</span>).</p>
<p>The rate of water loss for an amphibian without fully wetted skin can be expressed as <span class="math display">\[E_c= A (\rho_s-h\rho_a)/(r_i+r_e),\]</span> where <span class="math inline">\(r_i\)</span> is the internal (cutaneous) resistance to vapor transport (<span class="math inline">\(s/m\)</span>).</p>
<p>We provide R functions for heat loss through evaporation as the product of <span class="math inline">\(E_c\)</span> and the latent heat of vaporization of water:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vp=<span class="st"> </span><span class="kw"><a href="../reference/saturation_vapor_pressure.html">saturation_vapor_pressure</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>)<span class="co">#kPa</span>
<span class="co">#convert to kg/m^3</span>
rho_s=<span class="st"> </span>vp<span class="op">*</span><span class="fl">0.032</span> <span class="co">#kg/m^3</span>

vp=<span class="st"> </span><span class="kw"><a href="../reference/saturation_vapor_pressure.html">saturation_vapor_pressure</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span><span class="op">-</span><span class="dv">10</span>)<span class="co">#kPa</span>
<span class="co">#convert to kg/m^3</span>
rho_a=<span class="st"> </span>vp<span class="op">*</span><span class="fl">0.032</span> <span class="co">#kg/m^3</span>

temps=<span class="st"> </span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>
Qevaps=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>,<span class="dv">21</span>)
Qevaps_wet=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>,<span class="dv">21</span>)

<span class="cf">for</span>(ind <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">21</span>){
 Qevaps[ind]=<span class="kw"><a href="../reference/Qevaporation.html">Qevaporation</a></span>(<span class="dt">A=</span><span class="fl">0.1</span>, <span class="dt">T_b=</span>temps[ind], <span class="dt">taxa=</span><span class="st">"amphibian"</span>, <span class="dt">rho_s=</span>rho_s[ind], <span class="dt">rho_a=</span>rho_a[ind], <span class="dt">h=</span><span class="fl">0.5</span>, <span class="dt">H=</span><span class="dv">20</span>, <span class="dt">r_i=</span><span class="dv">50</span>) 
Qevaps_wet[ind]=<span class="kw"><a href="../reference/Qevaporation.html">Qevaporation</a></span>(<span class="dt">A=</span><span class="fl">0.1</span>, <span class="dt">T_b=</span>temps[ind], <span class="dt">taxa=</span><span class="st">"amphibian_wetskin"</span>, <span class="dt">rho_s=</span>rho_s[ind], <span class="dt">rho_a=</span>rho_a[ind], <span class="dt">h=</span><span class="fl">0.5</span>, <span class="dt">H=</span><span class="dv">20</span>, <span class="dt">r_i=</span><span class="dv">50</span>) 
 }

<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(temps, Qevaps, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"body temperature (K)"</span>, <span class="dt">ylab =</span> <span class="st">"evaporative heat loss (W)"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>, <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">400</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(temps, Qevaps_wet, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)

Qevap=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">FUN=</span>Qevaporation, <span class="dt">A=</span><span class="fl">0.1</span>, <span class="dt">taxa=</span><span class="st">"lizard"</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, Qevap, <span class="dt">type=</span><span class="st">"l"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"right"</span>, <span class="dt">title=</span><span class="st">"taxa"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"amphibian"</span>,<span class="st">"amphibian_wetskin"</span>,<span class="st">"lizard"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"solid"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
<p>We estimate external resistance to water vapor transport, <span class="math inline">\(r_e\)</span>, using the Lewis rule describing the relationships among the coefficients for heat and mass transport: <span class="math inline">\(r_e= 0.93 \rho c_p/H_L\)</span>, where <span class="math inline">\(\rho\)</span> is the density of air (<span class="math inline">\(kg m^{-3}\)</span>), <span class="math inline">\(c_p\)</span> is the specific heat of air at constant pressure (<span class="math inline">\(J kg^{-1}*°C^{-1}\)</span>), and <span class="math inline">\(H_L\)</span> is the convective heat transfer coefficient (<span class="math inline">\(W m^{-2} °C^{-1}\)</span>). We approximate <span class="math inline">\(\rho c_p\)</span>as 1,200 <span class="math inline">\(J m^{-3}*°C^{-1}\)</span> as commonly done in biological applications <span class="citation">(Spotila, O’connor, and Bakken 1992)</span>. We provide the relationship for <span class="math inline">\(r_e\)</span> as a function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">10</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/external_resistance_to_water_vapor_transfer.html">external_resistance_to_water_vapor_transfer</a></span>(<span class="dt">H=</span><span class="dv">10</span><span class="op">:</span><span class="dv">30</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"heat transfer coefficient"</span> <span class="op">~</span><span class="st"> </span>(W <span class="op">~</span><span class="st"> </span>m<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>} <span class="op">~</span><span class="st"> "°"</span> <span class="op">~</span><span class="st"> </span>C<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})), <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"external resistance,"</span> <span class="op">~</span><span class="st"> </span>r[e] <span class="op">~</span><span class="st"> </span>(sm<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})))</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-21-1.png" width="576"></p>
<p>At constant temperatures, the relationship between vapor pressure and vapor density is linear and vapor pressure can be approximated at temperatures between <span class="math inline">\(0°C\)</span> and <span class="math inline">\(40°C\)</span> as <span class="math inline">\(e_s= 10^{0.02604 T_a+2.82488}\)</span>, where <span class="math inline">\(T_a\)</span> is air temperature (<span class="math inline">\(°C\)</span>). We provide the approximation as a function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">10</span><span class="op">:</span><span class="dv">30</span>, <span class="kw"><a href="../reference/saturation_water_vapor_pressure.html">saturation_water_vapor_pressure</a></span>(<span class="dt">T_a=</span><span class="dv">10</span><span class="op">:</span><span class="dv">30</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"temperature (°C)"</span>, <span class="dt">ylab =</span> <span class="st">"saturation water vapor pressure (Pa)"</span>)</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-22-1.png" width="576"></p>
</div>
<div id="solving-for-operative-environmental-temperature-te" class="section level1">
<h1 class="hasAnchor">
<a href="#solving-for-operative-environmental-temperature-te" class="anchor"></a>Solving for operative environmental temperature, Te</h1>
<p>TrenchR primarily includes models for calculating the operative temperatures of organisms that have reached an equilibrium with their environment (“steady-state”, no heat retention). The following function uses the relationships above to solve the energy balance for <span class="math inline">\(Te\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">FUN=</span>Tb_Gates, <span class="dt">A=</span><span class="fl">0.1</span>, <span class="dt">D=</span><span class="fl">0.001</span>, <span class="dt">psa_dir=</span><span class="fl">0.6</span>, <span class="dt">psa_ref=</span><span class="fl">0.4</span>, <span class="dt">psa_air=</span><span class="fl">0.6</span>, <span class="dt">psa_g=</span><span class="fl">0.0</span>, <span class="dt">T_g=</span><span class="dv">303</span>, <span class="dt">Qabs=</span><span class="dv">10</span>, <span class="dt">epsilon=</span><span class="fl">0.95</span>, <span class="dt">H_L=</span><span class="dv">10</span>, <span class="dt">ef=</span><span class="fl">1.3</span>, <span class="dt">K=</span><span class="fl">0.5</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ambient temperature, Ta (K)"</span>, <span class="dt">ylab =</span> <span class="st">"body temperature, Tb (K)"</span>, <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">295</span>,<span class="dv">315</span>), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">295</span>,<span class="dv">315</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">"gray"</span>)

t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">FUN=</span>Tb_Gates, <span class="dt">A=</span><span class="fl">0.1</span>, <span class="dt">D=</span><span class="fl">0.001</span>, <span class="dt">psa_dir=</span><span class="fl">0.6</span>, <span class="dt">psa_ref=</span><span class="fl">0.4</span>, <span class="dt">psa_air=</span><span class="fl">0.6</span>, <span class="dt">psa_g=</span><span class="fl">0.0</span>, <span class="dt">T_g=</span><span class="dv">303</span>, <span class="dt">Qabs=</span><span class="dv">0</span>, <span class="dt">epsilon=</span><span class="fl">0.95</span>, <span class="dt">H_L=</span><span class="dv">10</span>, <span class="dt">ef=</span><span class="fl">1.3</span>, <span class="dt">K=</span><span class="fl">0.5</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">FUN=</span>Tb_Gates, <span class="dt">A=</span><span class="fl">0.1</span>, <span class="dt">D=</span><span class="fl">0.001</span>, <span class="dt">psa_dir=</span><span class="fl">0.6</span>, <span class="dt">psa_ref=</span><span class="fl">0.4</span>, <span class="dt">psa_air=</span><span class="fl">0.6</span>, <span class="dt">psa_g=</span><span class="fl">0.0</span>, <span class="dt">T_g=</span><span class="dv">303</span>, <span class="dt">Qabs=</span><span class="dv">20</span>, <span class="dt">epsilon=</span><span class="fl">0.95</span>, <span class="dt">H_L=</span><span class="dv">10</span>, <span class="dt">ef=</span><span class="fl">1.3</span>, <span class="dt">K=</span><span class="fl">0.5</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>, <span class="dt">title=</span><span class="st">"Radiation, Qabs"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>,<span class="st">"solid"</span>,<span class="st">"dotted"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-23-1.png" width="576"></p>
<p>Campbell and Norman <span class="citation">(2012)</span> use a somewhat simplified energy balance to express <span class="math inline">\(Te\)</span> as a function of <span class="math inline">\(Ta\)</span> plus or minus a temperature increment determined by absorbed radiation, wind speed, and animal morphology: <span class="math display">\[ Te=Ta+(Sabs-Qemit)/(c_p(g_r+g_{Ha})),\]</span> where <span class="math inline">\(Ta\)</span> is air temperature <span class="math inline">\((K)\)</span>, <span class="math inline">\(Sabs\)</span> is the solar and thermal radiation absorbed (<span class="math inline">\(W m^{-2}\)</span>), <span class="math inline">\(Qemit\)</span> is emitted thermal radiation (<span class="math inline">\(W m^{-2}\)</span>), <span class="math inline">\(c_p\)</span> is the specific heat of air (<span class="math inline">\(J mol^{-1} K^{-1}\)</span>), <span class="math inline">\(g_{r}\)</span> is radiative conductance, and <span class="math inline">\(g_{Ha}\)</span> is the boundary conductance. The model is based on estimating <span class="math inline">\(T_e\)</span> for a blackbody (perfectly absorbing) cavity with air temperatures equal to surface temperatures (<span class="math inline">\(T_a=T_s\)</span>). The model assumes that the cavity provides the same heat load as the nautral environment and thus equates metabolic heat production and evaporative cooling in the two environments. The formulation assumes a well mixed interior of the animal and also omits conduction with the substrate. In this scenario, organisms emit thermal radiation from their surface proproportional to the fourth power of <span class="math inline">\(T_a\)</span>: <span class="math display">\[Q_{emit}= \epsilon \sigma T_a^4 ,\]</span> where <span class="math inline">\(\epsilon\)</span> is the proprtional longwave infrared emissivity of skin (0.95-1 for most animals, <span class="citation">(Gates 2012)</span>) and <span class="math inline">\(\sigma\)</span> is the Stefan-Boltzmann constant (<span class="math inline">\(5.673*10^{-8} W m^{-2} K^{-4)}\)</span>).</p>
<p>The thermal radiation exchanged between the animals and the walls of the cavity is proportional to the temperature differences and the radiative conductance. Cambell and Norman <span class="citation">(2012)</span> thus use a denominator term that combines thermal radiative exchange with convective heat exchange. The radiative conductance describing the heat exchange between the core of the animal and the environment is estimated as <span class="math inline">\(g_r= 4 \sigma Ta^3/c_p\)</span> <span class="math inline">\((mol*m^{-2} s^{-1})\)</span>. The boundary conductance (heat exchange with the air via convection) is estimated assuming forced convection driven by naturally turbulent wind and an empirical approximation of animal shapes <span class="citation">(J. W. Mitchell 1976)</span>: <span class="math display">\[g_{Ha}(mol \:m^{-2} s^{-1})= 1.4 * 0.135 \sqrt{(V/D)},\]</span> where 1.4 is a factor to account for increased convection in natural environments, <span class="math inline">\(V\)</span> is wind speed (<span class="math inline">\(m/s\)</span>), and <span class="math inline">\(D\)</span> is the characteristic dimension of the animal (<span class="math inline">\(m\)</span>).</p>
<p>The function to calculate <span class="math inline">\(T_e\)</span> (called <span class="math inline">\(T_b\)</span> for simplicity) is available in R follows (including the above calculations of <span class="math inline">\(Qemit\)</span>, <span class="math inline">\(g_r\)</span>, and <span class="math inline">\(g_{Ha}\)</span>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Tb_CampbellNorman.html">Tb_CampbellNorman</a></span>(<span class="dt">T_a=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">S=</span><span class="dv">800</span>, <span class="dt">epsilon=</span><span class="fl">0.96</span>, <span class="dt">c_p=</span><span class="fl">29.3</span>, <span class="dt">D=</span><span class="fl">0.17</span>, <span class="dt">V=</span><span class="dv">1</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"air temperature (K)"</span>, <span class="dt">ylab =</span> <span class="st">"body temperature (K)"</span>, <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">295</span>,<span class="dv">310</span>), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">290</span>,<span class="dv">325</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">a=</span><span class="dv">0</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">"gray"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Tb_CampbellNorman.html">Tb_CampbellNorman</a></span>(<span class="dt">T_a=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">S=</span><span class="dv">400</span>, <span class="dt">epsilon=</span><span class="fl">0.96</span>, <span class="dt">c_p=</span><span class="fl">29.3</span>, <span class="dt">D=</span><span class="fl">0.17</span>, <span class="dt">V=</span><span class="dv">1</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="kw"><a href="../reference/Tb_CampbellNorman.html">Tb_CampbellNorman</a></span>(<span class="dt">T_a=</span><span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">S=</span><span class="dv">600</span>, <span class="dt">epsilon=</span><span class="fl">0.96</span>, <span class="dt">c_p=</span><span class="fl">29.3</span>, <span class="dt">D=</span><span class="fl">0.17</span>, <span class="dt">V=</span><span class="dv">1</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>, <span class="dt">title=</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"Radiation, Sabs"</span> <span class="op">~</span><span class="st"> </span>(W <span class="op">~</span><span class="st"> </span>m<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>})), <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">400</span>,<span class="dv">600</span>,<span class="dv">800</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"solid"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-24-1.png" width="576"></p>
<div id="fei" class="section level2">
<h2 class="hasAnchor">
<a href="#fei" class="anchor"></a>Fei</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">FUN=</span>Tb_Fei, <span class="dt">T_g=</span><span class="dv">300</span>, <span class="dt">H=</span><span class="dv">800</span>, <span class="dt">lw=</span><span class="dv">30</span>, <span class="dt">shade=</span><span class="fl">0.5</span>, <span class="dt">m=</span><span class="fl">10.5</span>, <span class="dt">Acondfact=</span><span class="fl">0.05</span>, <span class="dt">Agradfact=</span><span class="fl">0.4</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ambient temperature (°C)"</span>, <span class="dt">ylab =</span> <span class="st">"body temperature (°C)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">"gray"</span>)

t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">FUN=</span>Tb_Fei, <span class="dt">T_g=</span><span class="dv">300</span>, <span class="dt">H=</span><span class="dv">800</span>, <span class="dt">lw=</span><span class="dv">30</span>, <span class="dt">shade=</span><span class="fl">0.0</span>, <span class="dt">m=</span><span class="fl">10.5</span>, <span class="dt">Acondfact=</span><span class="fl">0.05</span>, <span class="dt">Agradfact=</span><span class="fl">0.4</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">FUN=</span>Tb_Fei, <span class="dt">T_g=</span><span class="dv">300</span>, <span class="dt">H=</span><span class="dv">800</span>, <span class="dt">lw=</span><span class="dv">30</span>, <span class="dt">shade=</span><span class="fl">1.0</span>, <span class="dt">m=</span><span class="fl">10.5</span>, <span class="dt">Acondfact=</span><span class="fl">0.05</span>, <span class="dt">Agradfact=</span><span class="fl">0.4</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>, <span class="dt">title=</span><span class="st">"proportion shade"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.0</span>,<span class="fl">0.5</span>,<span class="fl">1.0</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>,<span class="st">"solid"</span>,<span class="st">"dotted"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-25-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#STARTED TO FIX</span></code></pre></div>
</div>
</div>
<div id="specialized-energy-balance-models-and-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#specialized-energy-balance-models-and-functions" class="anchor"></a>Specialized energy balance models and functions</h1>
<p>In addition to providing general functions that can be used to build heat budget models predicting the body temperatures for a variety of organisms, we implement specialized operative temperature models that have been developed for a variety of organisms.</p>
<div id="lizards" class="section level2">
<h2 class="hasAnchor">
<a href="#lizards" class="anchor"></a>Lizards</h2>
<p>We adapted a biophysical model (<code><a href="../reference/Tb_lizard.html">Tb_lizard()</a></code>) to calculate operative environmental temperature, <span class="math inline">\(T_e\)</span>, for lizards from Buckley <span class="citation">(2007)</span>. The function follows the modeling approach contained Campbell and Norman <span class="citation">(2012)</span>.</p>
<div id="day-length-and-sun-angles" class="section level3">
<h3 class="hasAnchor">
<a href="#day-length-and-sun-angles" class="anchor"></a>Day Length and Sun Angles</h3>
<p>The function constrains the lizard’s foraging to hours of daylight and uses the relations below to calculate day length and the time of solar noon. The function calculates the solar declination, <span class="math inline">\(\delta\)</span> (rad), the angular distance of the sun north or south of the earth’s equator: <span class="math display">\[\delta= \arcsin[0.39795 \cos(0.21631+2 \arctan (0.967 \tan [0.0086(-186+J)]))] \]</span> where <span class="math inline">\(J\)</span> is calendar day, with <span class="math inline">\(J=1\)</span> at January 1. One can then calculate day length, <span class="math inline">\(h_{day} (h)\)</span>, using the CBM model <span class="citation">(Forsythe et al. 1995)</span>: where <span class="math inline">\(\phi\)</span> is latitude (rad).</p>
<p>The time of solar noon (<span class="math inline">\(h\)</span>) is calculated as <span class="math inline">\(t_0=12-LC-ET\)</span> where <span class="math inline">\(LC\)</span> is the longitude correction (h) and <span class="math inline">\(ET\)</span> is the equation of time (h). The <span class="math inline">\(LC\)</span> is a +1/15-h correction for each degree that a location is west of a standard meridian, which occurs at 0°, 15°, …, 345°. The ET corrects for the difference between sun time and clock time based on calendar day as follows: <span class="math display">\[ET=\frac{-104.7\sin f+596.2 \sin{2f} +4.3 \sin{3f} -12.7 \sin{4f} -429.3 \cos{f} -2.0 \cos{2f}+19.3 \cos{3f}}{3600},\\f=\frac{\pi}{180}(279.575+0.9856J)\]</span> The zenith angle, <span class="math inline">\(\psi\)</span> (rad), is the sun angle measured from vertical, <span class="math inline">\(\cos{\psi}=\sin\delta \sin\phi + \cos\delta \cos\phi\cos\frac{\pi}{12(h-t_0)}\)</span>, where <span class="math inline">\(h\)</span> is hour.</p>
</div>
<div id="radiation-and-environmental-temperature" class="section level3">
<h3 class="hasAnchor">
<a href="#radiation-and-environmental-temperature" class="anchor"></a>Radiation and Environmental Temperature</h3>
<p>Central to the thermal influence of radiation is the Stefan‐Boltzmann law, which expresses the total radiant energy over all wavelengths admitted per unit surface area of a blackbody radiator. The law yields the emitted flux density, B (<span class="math inline">\(W m^2\)</span>), <span class="math inline">\(B= \sigma(T_a+273)^4\)</span>, where <span class="math inline">\(\omega\)</span> is the Stefan‐Boltzmann constant (<span class="math inline">\(5.67×10^{−8} W m^{−2} K^{−4}\)</span>). Emissivity, <span class="math inline">\(\epsilon(\lambda)\)</span>, where <span class="math inline">\(\lambda\)</span> is wavelength, is the fraction of blackbody emittance at a given wavelength emitted by the surface of a material. Gray bodies are those with no wavelength dependence of the emissivity. Thus, emitted energy of a gray body is <span class="math inline">\(\phi (W m^{−2})= \epsilon B\)</span>. We assume lizards are a gray body, which is reasonable for most natural surfaces. The emissivity of most natural surfaces ranges from 0.95 to 1.0. The function uses the emissivity value of 0.965 measured by Bartlett and Gates (1967) for a <em>Sceloporus</em> lizard. However, the emissivity of a clear atmosphere is substantially lower. We use the approximation by Swinbank (1963) to estimate clear sky emissivity, <span class="math inline">\(\epsilon_{ac}=9.2 * 10^{-6}(T_a+273)^2.\)</span></p>
<p>We first consider convective heat transport between the lizard’s body and the environment. The boundary conductance of air (<span class="math inline">\(mol \: m^{−2} s^{−1}\)</span>) is expressed as <span class="math display">\[g_{Ha}=1.4*0.135 \sqrt{u/d} ,\]</span> where <span class="math inline">\(u\)</span> is wind velocity (<span class="math inline">\(m s^{−1}\)</span>) and <span class="math inline">\(d\)</span> is the characteristic dimension (<span class="math inline">\(m\)</span>). Assuming that wind is blowing parallel to the axis of a cylindrical approximation of a lizard, <span class="math inline">\(d\)</span> is the lizard’s length (snout‐vent length [m]). A factor of 1.4 is introduced to account for the increased convection due to environmental turbulence <span class="citation">(J. W. Mitchell 1976)</span>. We additionally consider radiative conductance, the exchange of thermal radiation between the lizard and the environment proportional to temperature differences. The radiative conductance (<span class="math inline">\(mol \:m^{−2} s^{−1}\)</span>) is expressed as <span class="math display">\[g_r=\frac{4 \epsilon \sigma (T_a+273)^3}{c_p},\]</span> where <span class="math inline">\(c_p\)</span> is the specific heat of air (29.3 <span class="math inline">\(J \: mol^{−1} K^{−1}\)</span>).</p>
<p>We then turn to calculating the components of the radiant energy budget of a lizard. We estimate the solar (shortwave) component of this quantity by aggregating flux densities for four radiation streams: the direct irradiance on a surface perpendicular to the beam, <span class="math inline">\(S_p (W m^{−2})\)</span>; the diffuse sky irradiance on a horizontal plane, <span class="math inline">\(S_d (W m^{−2})\)</span>; the total irradiance of a horizontal surface, <span class="math inline">\(S_t (W m^{−2})\)</span>; and the reflected radiation from the ground, <span class="math inline">\(S_r (W m^{−2})\)</span>. Calculation of these flux densities requires the introduction of several additional quantities. The atmospheric transmissivity, <span class="math inline">\(\tau\)</span>, ranges between 0.6 and 0.7 for typical clear sky conditions (Gates 1980). We thus assume <span class="math inline">\(\tau=0.65\)</span>. The solar constant, <span class="math inline">\(S_{p0}\)</span>, indicates extraterrestrial flux density to be <span class="math inline">\(1,360 W m^{−2}\)</span>. Optical air mass number, <span class="math inline">\(m_a\)</span>, is the ratio of slant path length through the atmosphere to zenith path length and is a function of atmospheric pressure, <span class="math inline">\(p_a (kPa)\)</span>: <span class="math display">\[p_a=101.3exp(-E/8200),\]</span> where <span class="math inline">\(E\)</span> is the elevation in meters above sea level. We can then calculate <span class="math inline">\(m_a\)</span> as <span class="math inline">\(m_a=\frac{p_a}{101.3 \cos\psi}\)</span>.</p>
<p>Direct irradiance is a function of the distance a solar beam travels through the atmosphere; the transmittance of the atmosphere, <span class="math inline">\(\tau\)</span>; and the incident flux density, <span class="math inline">\(S_{p0}\)</span>: <span class="math inline">\(S_p=S_{p0}\tau^{m_a}\)</span>. Sky diffuse radiation can be approximated using an empirical relation [Liu and Jordan 1960], <span class="math inline">\(S_d=0.3(1-\tau^{m_a})S_{p0}\cos\psi\)</span>. Solar irradiance is the sum of diffuse sky irradiance and the beam irradiance on a surface: <span class="math inline">\(S_t=S_d+S_p \cos\psi\)</span>. Finally, reflected radiation is the product of albedo, <span class="math inline">\(\rho_S\)</span>, and the total shortwave irradiance: <span class="math inline">\(S_r=\rho_S S_t\)</span>. Albedo was empirically derived from satellite images and is the surface reflectance for the solar waveband.</p>
<p>The longwave component of a lizard’s radiant energy budget can be estimated using the Stefan‐Boltzmann law. The longwave flux density from atmosphere, <span class="math inline">\(L_a (W m^{−2})\)</span>, is computed as <span class="math inline">\(L_a=\epsilon_{ac}\sigma(T_a+273)^4\)</span>, where <span class="math inline">\(\epsilon_{ac}\)</span> is clear sky emissivity. The longwave flux density from the ground is <span class="math inline">\(L_g=\epsilon_s \sigma T_s^4\)</span>, where <span class="math inline">\(\epsilon_s\)</span> is surface emissivity.</p>
<p>One can then aggregate short‐ and longwave radiation to compute absorbed radiation: <span class="math display">\[R_{abs}+\alpha_s(F_PS_p+F_dS_d+F_rS_r)+\alpha_L(F_aL_a+F_gL_g) ,\]</span> where <span class="math inline">\(\alpha_S\)</span> and <span class="math inline">\(\alpha_L\)</span> are the absorptivities in the solar and thermal wavebands, respectively, and <span class="math inline">\(F_p\)</span>, <span class="math inline">\(F_d\)</span>, <span class="math inline">\(F_r\)</span>, <span class="math inline">\(F_a\)</span>, and <span class="math inline">\(F_g\)</span> are view factors between the surface of the lizard and sources of radiation. Solar absorptivity, <span class="math inline">\(\alpha_S\)</span>, is approximately 0.9 for lizards <span class="citation">(Gates 2012)</span>. Because absorptivity in a given waveband is equal to emissivity in that waveband, we use the thermal absorptivity, <span class="math inline">\(\alpha_L\)</span>, of 0.965, as measured by Bartlett and Gates <span class="citation">(1967)</span>.</p>
<p>View factors refer to the fraction of radiation that is intercepted by the lizard. The beam view factor, <span class="math inline">\(F_p\)</span>, for a lizard is the ratio of the projected area perpendicular to the solar beam, <span class="math inline">\(A_p\)</span>, to the total animal area, <span class="math inline">\(A\)</span>, <span class="math inline">\(F_p=A_p/A\)</span>. We use an empirically derived relationship that was developed for a standing <em>Callisaurus</em> [<span class="citation">Muth (1977)</span>. We assume a relative azimuth angle of 90°, which indicates that the long axis of the lizard is perpendicular to incoming solar radiation: <span class="math display">\[ A_p= \frac{[(-1.1756*10^{-4})\psi^2+(-9.2594*10^{-2})\psi+26.2409]A}{100}.\]</span> Roughgarden et al. <span class="citation">(1981)</span> provide an expression for total area based on empirical lizard data from Norris <span class="citation">(1967)</span> and Porter and James <span class="citation">(1979)</span>: <span class="math inline">\(A=0.121m^{0.688}\)</span> <span class="math inline">\((r^2=0.996),\)</span> where <span class="math inline">\(m\)</span> is mass in grams, and the relation holds for a variety of lizards from 2 to 50 g. For diffuse shortwave and longwave radiation, the sky can be approximated as a hemisphere. The diffuse radiation view factor, <span class="math inline">\(F_d\)</span>, for a standing lizard was found to be 0.8 by Bartlett and Gates <span class="citation">(1967)</span>. We assume that one‐half of thermal radiation is received from both the ground and the sky. The atmospheric thermal radiation factor, <span class="math inline">\(F_a\)</span>, is thus 0.5, and the ground thermal radiation factor, <span class="math inline">\(F_g\)</span>, is 0.5. We likewise assume that the reflected solar radiation view factor, <span class="math inline">\(F_r\)</span>, is 0.5. The operative environmental temperature is calculated within each grid cell as <span class="math display">\[Te=Ta+\frac{Rabs-\epsilon_s \sigma (T_a+273)^4}{c_p(g_r+g_{Ha})}\]</span>.</p>
<p>We implement the model in TrenchR as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#sun, surface</span>
t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_lizard, <span class="dt">T_g=</span><span class="dv">30</span>, <span class="dt">u=</span><span class="fl">0.1</span>, <span class="dt">svl=</span><span class="dv">60</span>, <span class="dt">m=</span><span class="dv">10</span>, <span class="dt">psi=</span><span class="dv">34</span>, <span class="dt">rho_S=</span><span class="fl">0.7</span>, <span class="dt">elev=</span><span class="dv">500</span>, <span class="dt">doy=</span><span class="dv">200</span>, <span class="dt">sun=</span><span class="ot">TRUE</span>, <span class="dt">surface=</span><span class="ot">TRUE</span>, <span class="dt">alpha_S=</span><span class="fl">0.9</span>, <span class="dt">alpha_L=</span><span class="fl">0.965</span>, <span class="dt">epsilon_s=</span><span class="fl">0.965</span>, <span class="dt">F_d=</span><span class="fl">0.8</span>, <span class="dt">F_r=</span><span class="fl">0.5</span>, <span class="dt">F_a=</span><span class="fl">0.5</span>, <span class="dt">F_g=</span><span class="fl">0.5</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ambient temperature (°C)"</span>, <span class="dt">ylab =</span> <span class="st">"body temperature (°C)"</span>, <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">20</span>,<span class="dv">40</span>), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">20</span>,<span class="dv">51</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">"gray"</span>)
<span class="co">#shade, surface</span>
t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_lizard, <span class="dt">T_g=</span><span class="dv">30</span>, <span class="dt">u=</span><span class="fl">0.1</span>, <span class="dt">svl=</span><span class="dv">60</span>, <span class="dt">m=</span><span class="dv">10</span>, <span class="dt">psi=</span><span class="dv">34</span>, <span class="dt">rho_S=</span><span class="fl">0.7</span>, <span class="dt">elev=</span><span class="dv">500</span>, <span class="dt">doy=</span><span class="dv">200</span>, <span class="dt">sun=</span><span class="ot">FALSE</span>, <span class="dt">surface=</span><span class="ot">TRUE</span>, <span class="dt">alpha_S=</span><span class="fl">0.9</span>, <span class="dt">alpha_L=</span><span class="fl">0.965</span>, <span class="dt">epsilon_s=</span><span class="fl">0.965</span>, <span class="dt">F_d=</span><span class="fl">0.8</span>, <span class="dt">F_r=</span><span class="fl">0.5</span>, <span class="dt">F_a=</span><span class="fl">0.5</span>, <span class="dt">F_g=</span><span class="fl">0.5</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="co">#sun, above surface</span>
t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_lizard, <span class="dt">T_g=</span><span class="dv">30</span>, <span class="dt">u=</span><span class="fl">0.1</span>, <span class="dt">svl=</span><span class="dv">60</span>, <span class="dt">m=</span><span class="dv">10</span>, <span class="dt">psi=</span><span class="dv">34</span>, <span class="dt">rho_S=</span><span class="fl">0.7</span>, <span class="dt">elev=</span><span class="dv">500</span>, <span class="dt">doy=</span><span class="dv">200</span>, <span class="dt">sun=</span><span class="ot">TRUE</span>, <span class="dt">surface=</span><span class="ot">FALSE</span>, <span class="dt">alpha_S=</span><span class="fl">0.9</span>, <span class="dt">alpha_L=</span><span class="fl">0.965</span>, <span class="dt">epsilon_s=</span><span class="fl">0.965</span>, <span class="dt">F_d=</span><span class="fl">0.8</span>, <span class="dt">F_r=</span><span class="fl">0.5</span>, <span class="dt">F_a=</span><span class="fl">0.5</span>, <span class="dt">F_g=</span><span class="fl">0.5</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="co">#shade, above surface</span>
t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_lizard, <span class="dt">T_g=</span><span class="dv">30</span>, <span class="dt">u=</span><span class="fl">0.1</span>, <span class="dt">svl=</span><span class="dv">60</span>, <span class="dt">m=</span><span class="dv">10</span>, <span class="dt">psi=</span><span class="dv">34</span>, <span class="dt">rho_S=</span><span class="fl">0.7</span>, <span class="dt">elev=</span><span class="dv">500</span>, <span class="dt">doy=</span><span class="dv">200</span>, <span class="dt">sun=</span><span class="ot">FALSE</span>, <span class="dt">surface=</span><span class="ot">FALSE</span>, <span class="dt">alpha_S=</span><span class="fl">0.9</span>, <span class="dt">alpha_L=</span><span class="fl">0.965</span>, <span class="dt">epsilon_s=</span><span class="fl">0.965</span>, <span class="dt">F_d=</span><span class="fl">0.8</span>, <span class="dt">F_r=</span><span class="fl">0.5</span>, <span class="dt">F_a=</span><span class="fl">0.5</span>, <span class="dt">F_g=</span><span class="fl">0.5</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>,<span class="dt">title=</span><span class="st">"parameters"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sun, surface"</span>,<span class="st">"shade, surface"</span>,<span class="st">"sun, above surface"</span>,<span class="st">"shade, above surface"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-26-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#? Include transient heat model in package?: https://github.com/JRubalcaba/BodyTemp.</span></code></pre></div>
</div>
</div>
<div id="butterflies" class="section level2">
<h2 class="hasAnchor">
<a href="#butterflies" class="anchor"></a>Butterflies</h2>
<p>We adapted a biophysical model for <em>Colias</em> that was developed and field validated by Kingsolver <span class="citation">(1983)</span> to predict thoracic body temperature (<span class="math inline">\(T_b\)</span>) based on thermoregulatory traits (body size, basal ventral hind wing solar absorptivity, and thoracic fur thickness), behavioral posture (basking and heat-avoidance), and environmental conditions. We briefly describe the model, which was updated and detailed in Buckley and Kingsolver <span class="citation">(2012)</span>. Adults behaviorally thermoregulate to achieve the body temperatures needed for flight, and do not use endogenous heat production to elevate body temperatures. We assume that butterflies select the body temperature closest to their thermal optima (35°C) with available body temperatures bracketed by those in full sun (lateral basking posture with wings closed and the ventral hindwing surfaces oriented perpendicular to the sun) and full shade (no direct radiation). Assuming that butterflies select body temperatures bracketed by full sun and full shade eliminates the need to attempt to model microclimate availability in detail.</p>
<p>We describe the steady-state energy flux balance of a butterfly at rest on vegetation as <span class="math display">\[Q_s= Q_t + Q_c,\]</span> where <span class="math inline">\(Q_s\)</span> is the total solar radiative heat flux, <span class="math inline">\(Q_t\)</span> is the thermal radiative heat flux, and <span class="math inline">\(Q_c\)</span> is the convective heat flux. Conduction of heat between the body and vegetation and evaporative heat loss are considered to be negligible. The solar radiative heat flux is <span class="math display">\[ Q_s= Q_{s,dir}+Q_{s,dif}+Q_{s,ref},\\ Q_s= \alpha A_{s,dir}H_{s,dir}/cos(z) +\alpha A_{s,ref}H_{s,dif}+\alpha r_g A_{s,ref}H_{s,ttl}, \]</span></p>
<p>where <span class="math inline">\(Q_{s,dir}\)</span>,<span class="math inline">\(Q_{s,dif}\)</span>,<span class="math inline">\(Q_{s,ref}\)</span> are the direct, diffuse, and reflected solar radiative fluxes, respectively; <span class="math inline">\(H_{s,dir}\)</span>,<span class="math inline">\(H_{s,dif}\)</span>,<span class="math inline">\(H_{s,ttl}\)</span> are the direct, diffuse, and total solar radiative horizontal flux densities, respectively; <span class="math inline">\(A_{s,dir}\)</span>,<span class="math inline">\(A_{s,ref}\)</span>,<span class="math inline">\(A_{s,ttl}\)</span> are the direct, reflected, and total solar radiative heat transfer surface areas, respectively; <span class="math inline">\(\alpha\)</span> is wing solar absorptivity; <span class="math inline">\(r_g\)</span> is substrate solar reflectivity; and <span class="math inline">\(z\)</span> is the zenith angle. We assume <span class="math inline">\(A_{s,dir}=A_{s,ref}= A_{s,ttl}\)</span>.</p>
<p>Thermal radiative flux including both downward radiation and reflected solar radiation is estimated as follows: <span class="math display">\[Q_t=0.5A_t \epsilon \sigma (T_b^4-T_{sky}^4)+0.5A_t \epsilon \sigma (T_b^4-T_g^4),\]</span> where <span class="math inline">\(A_t\)</span> is the thermal radiative heat transfer surface area, <span class="math inline">\(T_b\)</span> is the body temperature, <span class="math inline">\(T_g\)</span> is the ground surface temperature, <span class="math inline">\(T_{sky}\)</span> is the equivalent black body sky temperature, <span class="math inline">\(\epsilon\)</span> is butterfly thermal emissivity, and <span class="math inline">\(\sigma\)</span> is the Stefan-Boltzman constant.</p>
<p>The convective heat flux is given by: <span class="math display">\[Q_c= h_T A_c (T_b-T_a), \]</span> where <span class="math inline">\(A_c\)</span> is the convective heat transfer surface area and <span class="math inline">\(T_a\)</span> is the air temperature. We assume <span class="math inline">\(A_c=A_t= A_{s,ttl}\)</span>. The total convective heat transfer coefficient, <span class="math inline">\(h_T\)</span>, is calculated as the boundary layer conductance <span class="math inline">\(h_c\)</span> and the fur layer conduction in series: <span class="math display">\[1/h_T=1/h_c+\frac{(r_i+\delta)ln[(r_i+\delta)/r_i]}{k_e} ,\]</span> where <span class="math inline">\(\delta\)</span> is the thoracic fur thickness and <span class="math inline">\(k_e\)</span> is the thermal conductivity of the fur. The boundary layer conductance, <span class="math inline">\(h_c\)</span>, can be estimated using the relationship between two non-dimensional numbers. The Nusselt number, <span class="math inline">\(Nu=h_c D/ka\)</span>, is the ratio of convective to conductive heat transfer, where <span class="math inline">\(k_a\)</span> is the thermal conductivity of air. We used the maximum width of the mesothorax as the characteristic dimension of the butterfly, <span class="math inline">\(D\)</span>. The Reynolds number, <span class="math inline">\(Re=uD/v\)</span>, is the ratio of inertial forces to viscous forces, where <span class="math inline">\(u\)</span> is wind speed and <span class="math inline">\(v\)</span> is kinematic viscosity. We used the Nu-Re relation for a cylinder, <span class="math inline">\(Nu=0.6Re^{0.5}\)</span>, which is a reasonable approximation for <em>Colias</em>. We estimate energy flux balance in order to estimate <span class="math inline">\(T_b\)</span>.</p>
<p>We provide the operative temperature model for butterflies as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_butterfly, <span class="dt">Tg=</span><span class="dv">25</span>, <span class="dt">Tg_sh=</span><span class="dv">20</span>, <span class="dt">u=</span><span class="fl">0.4</span>, <span class="dt">H_sdir=</span><span class="dv">300</span>, <span class="dt">H_sdif=</span><span class="dv">100</span>, <span class="dt">z=</span><span class="dv">30</span>, <span class="dt">D=</span><span class="fl">0.36</span>, <span class="dt">delta=</span><span class="fl">1.46</span>, <span class="dt">alpha=</span><span class="fl">0.6</span>, <span class="dt">r_g=</span><span class="fl">0.3</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ambient temperature (°C)"</span>, <span class="dt">ylab =</span> <span class="st">"body temperature (°C)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">"gray"</span>)

t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_butterfly, <span class="dt">Tg=</span><span class="dv">25</span>, <span class="dt">Tg_sh=</span><span class="dv">20</span>, <span class="dt">u=</span><span class="fl">0.4</span>, <span class="dt">H_sdir=</span><span class="dv">100</span>, <span class="dt">H_sdif=</span><span class="dv">100</span>, <span class="dt">z=</span><span class="dv">30</span>, <span class="dt">D=</span><span class="fl">0.36</span>, <span class="dt">delta=</span><span class="fl">1.46</span>, <span class="dt">alpha=</span><span class="fl">0.6</span>, <span class="dt">r_g=</span><span class="fl">0.3</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_butterfly, <span class="dt">Tg=</span><span class="dv">25</span>, <span class="dt">Tg_sh=</span><span class="dv">20</span>, <span class="dt">u=</span><span class="fl">0.4</span>, <span class="dt">H_sdir=</span><span class="dv">500</span>, <span class="dt">H_sdif=</span><span class="dv">100</span>, <span class="dt">z=</span><span class="dv">30</span>, <span class="dt">D=</span><span class="fl">0.36</span>, <span class="dt">delta=</span><span class="fl">1.46</span>, <span class="dt">alpha=</span><span class="fl">0.6</span>, <span class="dt">r_g=</span><span class="fl">0.3</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>,<span class="dt">title=</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"direct radiation,"</span> <span class="op">~</span><span class="st"> </span>H[sdif]), <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">100</span>,<span class="dv">300</span>,<span class="dv">500</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>,<span class="st">"solid"</span>,<span class="st">"dotted"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-27-1.png" width="576"></p>
</div>
<div id="grasshoppers" class="section level2">
<h2 class="hasAnchor">
<a href="#grasshoppers" class="anchor"></a>Grasshoppers</h2>
<p>We provide a biophysical model (<code><a href="../reference/Tb_grasshopper.html">Tb_grasshopper()</a></code>) to predict grasshopper body temperatures <span class="citation">(Buckley, Nufio, and Kingsolver 2014, partially adapted from <span class="citation">Samietz, Salser, and Dingle (2005)</span>)</span>. We use an energy budget to describe the flow of energy between the grasshopper and the environment: <span class="math inline">\(Q_s=Q_t+Q_c+Q_{cond}\)</span>. Here <span class="math inline">\(Q_s\)</span> is the total input of heat due to solar radiation. <span class="math inline">\(Q_t\)</span> describes the flux of thermal radiative heat due to both incoming thermal radiation (ground and sky) and that emitted by the grasshopper. <span class="math inline">\(Q_c\)</span> is flux of heat between the grasshopper and the surrounding fluid (air) via convection. <span class="math inline">\(Q_{cond}\)</span> is the flux of heat between the grasshopper’s body and the solid surfaces with which the grasshopper’s body is in contact via conduction. We omit evaporative heat loss as it should be negligible for the grasshopper <span class="citation">(Anderson, Tracy, and Abramsky 1979)</span>.</p>
<p>The solar radiative heat flux is estimated as the sum of direct (<span class="math inline">\(Q_{s,dir}\)</span>), diffuse (<span class="math inline">\(Q_{s,dif}\)</span>), and reflected (<span class="math inline">\(Q_{s,ref}\)</span>) components <span class="citation">(Kingsolver 1983)</span>: <span class="math display">\[ Q_s= Q_{s,dir}+Q_{s,dif}+Q_{s,ref},\\ Q_s= \alpha A_{s,dir}H_{s,dir}/cos(z) +\alpha A_{s,ref}H_{s,dif}+\alpha r_g A_{s,ref}H_{s,ttl}. \]</span></p>
<p>Each component is calculated as the product of the solar absorptivity of the grasshopper (we assume <span class="math inline">\(\alpha=0.7\)</span>, <span class="citation">(Anderson, Tracy, and Abramsky 1979)</span>), the horizontal flux of solar radiation (<span class="math inline">\(H_{s,dir}\)</span>, <span class="math inline">\(H_{s,dif}\)</span>, and <span class="math inline">\(H_{s,ttl}\)</span> for the direct, diffuse, and total fluxes, respectively), and the silhouette area of the grasshopper exposed to solar radiation (<span class="math inline">\(A_{s,dir}\)</span>, <span class="math inline">\(A_{s,dif}\)</span>, and <span class="math inline">\(A_{s,ttl}\)</span> for the direct, diffuse, and total surface areas, respectively). The direct radiation is adjusted for the zenith angle (<span class="math inline">\(z\)</span>, degrees), which is the angle of the sun away from vertical.</p>
<p>We calculate the surface area by approximating the body of a female grasshopper as a rotational ellipsoid <span class="citation">(Samietz, Salser, and Dingle 2005)</span>. The major axis is equal to the grasshopper’s length. We calculate the semi-minor axis (half of the grasshopper’s width) as <span class="math inline">\(a=(0.365+0.241*1000 L)/1000\)</span> using a regression from Lactin and Johnson <span class="citation">(1998)</span>. If <span class="math inline">\(e=\sqrt{1-a^2/c^2}\)</span>, surface area can be calculated as follows: <span class="math display">\[A= 2 \pi a^2+\frac{2 \pi a c}{e \arcsin{e}}.\]</span> The ratio of silhouette area to surface area of a grasshopper is a linear function of zenith angle: <span class="math inline">\(A_s/A = 0.19-0.00173z\)</span>. Thus, <span class="math inline">\(A_{s,dir}=A_{s,ref}=(0.19-0.00173z)A\)</span>. We partitioned the observed total radiation (<span class="math inline">\(H_{s,ttl}\)</span>) into diffuse (<span class="math inline">\(H_{s,dif}\)</span>) and direct (<span class="math inline">\(H_{s,dir}\)</span>) components using the polynomial function of a clearness index, <span class="math inline">\(k_t\)</span>, developed by Erbs et al. <span class="citation">(1982)</span>.</p>
<p>We estimate thermal radiative flux as the sum of radiation from the sky and ground. We assume that one half of the grasshopper’s body is subject to atmospheric radiation and the other half is subject to thermal radiation from the ground surface. Thermal radiation is calculated using the Stefan-Boltmann law, which states that radiative flux is proportional to the forth power of the absolute temperature of a body. Here <span class="math inline">\(T_b\)</span> is the absolute body temperature, <span class="math inline">\(T_g\)</span> is the absolute ground surface temperature, and <span class="math inline">\(T_{sky}\)</span> is the equivalent black body sky temperature [<span class="math inline">\(T_{sky}=0.0552(T_a+273)^{1.5}\)</span>, <span class="citation">(Swinbank 1963)</span>]. The Stefan-Boltzmann constant (<span class="math inline">\(\sigma\)</span>) characterizes the proportionality of this relationship. The thermal emissivity (<span class="math inline">\(\epsilon\)</span>) accounts for incomplete absorption or emission of thermal radiation, but in this case we assume that both the grasshopper and ground are perfect black bodies (<span class="math inline">\(\epsilon=1\)</span>). We account for the thermal radiative heat transfer surface area (<span class="math inline">\(A_t=A\)</span>). The relationship is thus: <span class="math display">\[Q_t=0.5A_t \epsilon \sigma (T_b^4-T_{sky}^4)+0.5A_t \epsilon \sigma (T_b^4-T_g^4).\]</span></p>
<p>Convective heat flux is estimated as the product of the convective heat transfer coefficient in turbulent air (<span class="math inline">\(h_{cs}\)</span>), the grasshopper’s surface area exposed to convective heat flux (<span class="math inline">\(A_c=A\)</span>), and the temperature difference between the grasshopper’s body temperature (<span class="math inline">\(T_b\)</span>) and air temperature (<span class="math inline">\(T_a\)</span>): <span class="math display">\[Q_c= h_T A_c (T_b-T_a). \]</span> We calculate <span class="math inline">\(h_{cs}\)</span> from the convective heat transfer coefficient as <span class="math inline">\(h_{cs}=h_c(-0.007z/L+1.71)\)</span> where <span class="math inline">\(z\)</span>=0.001m is the height above the ground. We use an empirically-derived relationship for grasshoppers to estimate the heat transfer coefficient, <span class="math inline">\(h_c (Wm^{-2}*°C^{-1})\)</span> <span class="citation">(Lactin and Johnson 1998)</span>: <span class="math inline">\(h_c = Nu K_f/L\)</span>, where the thermal conductivity of fluid, <span class="math inline">\(K_f(W m^{-1}K^{-1})=0.024+0.00007(T_a+273)\)</span>.</p>
<p>We use an empirical relationship from Anderson et al. <span class="citation">(1998)</span> to estimate the Nusselt number, <span class="math inline">\(Nu\)</span>, as <span class="math inline">\(Nu=0.41 Re^{0.5}\)</span> where <span class="math inline">\(Re\)</span> is the Reynolds number. <span class="math inline">\(Re=u L/v\)</span>, where <span class="math inline">\(u\)</span> is windspeed (<span class="math inline">\(m/s\)</span>) and <span class="math inline">\(v\)</span> is the kinematic viscosity of air (<span class="math inline">\(m^2/s\)</span>) (<span class="math inline">\(v=15.68 \times 10^{-6}\)</span> at <span class="math inline">\(300K\)</span>).</p>
<p>The rate of conduction is a function of the body area in contact with the substrate and the temperature differential between the body and the surface: <span class="math display">\[Q_{cond}= h_{cut} A_{cond} (T_b-T_g)/T, \]</span> where <span class="math inline">\(h_{cut}\)</span> is the thermal conductivity of the grasshopper cuticle (approximated as <span class="math inline">\(0.15 W m^{-1} K^{-1}\)</span>; value for hornets; <span class="citation">(Galushko et al. 2005)</span>); <span class="math inline">\(A_{cond}\)</span> is the surface area of the grasshopper in contact with the substrate; and <span class="math inline">\(T\)</span> is the cuticle thickness (approximated as <span class="math inline">\(6 \times 10^{-5}m\)</span>; <span class="citation">(Galushko et al. 2005)</span>). We only model conductance through the cuticle as we assume that the interior of the grasshopper is well mixed.</p>
<p>We provide the operative temperature model for grasshoppers as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_grasshopper, <span class="dt">T_g=</span><span class="dv">25</span>, <span class="dt">u=</span><span class="fl">0.4</span>, <span class="dt">H=</span><span class="dv">800</span>, <span class="dt">K_t=</span><span class="fl">0.7</span>, <span class="dt">psi=</span><span class="dv">30</span>, <span class="dt">L=</span><span class="fl">0.05</span>, <span class="dt">Acondfact=</span><span class="fl">0.00</span>, <span class="dt">z=</span><span class="fl">0.001</span>, <span class="dt">abs=</span><span class="fl">0.7</span>, <span class="dt">r_g=</span><span class="fl">0.3</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ambient temperature (°C)"</span>, <span class="dt">ylab =</span> <span class="st">"body temperature (°C)"</span>, <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">20</span>,<span class="dv">40</span>), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">20</span>,<span class="dv">40</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">"gray"</span>)

t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_grasshopper, <span class="dt">T_g=</span><span class="dv">25</span>, <span class="dt">u=</span><span class="fl">0.4</span>, <span class="dt">H=</span><span class="dv">400</span>, <span class="dt">K_t=</span><span class="fl">0.7</span>, <span class="dt">psi=</span><span class="dv">30</span>, <span class="dt">L=</span><span class="fl">0.05</span>, <span class="dt">Acondfact=</span><span class="fl">0.00</span>, <span class="dt">z=</span><span class="fl">0.001</span>, <span class="dt">abs=</span><span class="fl">0.7</span>, <span class="dt">r_g=</span><span class="fl">0.3</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_grasshopper, <span class="dt">T_g=</span><span class="dv">25</span>, <span class="dt">u=</span><span class="fl">0.4</span>, <span class="dt">H=</span><span class="dv">600</span>, <span class="dt">K_t=</span><span class="fl">0.7</span>, <span class="dt">psi=</span><span class="dv">30</span>, <span class="dt">L=</span><span class="fl">0.05</span>, <span class="dt">Acondfact=</span><span class="fl">0.00</span>, <span class="dt">z=</span><span class="fl">0.001</span>, <span class="dt">abs=</span><span class="fl">0.7</span>, <span class="dt">r_g=</span><span class="fl">0.3</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>,<span class="dt">title=</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"direct radiation, H"</span>), <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">200</span>,<span class="dv">400</span>,<span class="dv">600</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"solid"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-28-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#clean up code?</span></code></pre></div>
</div>
<div id="salamander" class="section level2">
<h2 class="hasAnchor">
<a href="#salamander" class="anchor"></a>Salamander</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">40</span>, <span class="kw"><a href="../reference/actual_vapor_pressure.html">actual_vapor_pressure</a></span>(<span class="dt">Tdewpoint=</span><span class="dv">0</span><span class="op">:</span><span class="dv">40</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"dewpoint temperature (°C)"</span>, <span class="dt">ylab =</span> <span class="st">"vapor pressure (kPa)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">40</span>, <span class="kw"><a href="../reference/saturation_vapor_pressure.html">saturation_vapor_pressure</a></span>(<span class="dt">T_a=</span><span class="dv">273</span><span class="op">:</span>(<span class="dv">40</span><span class="op">+</span><span class="dv">273</span>)), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-29-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>))
blr.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, <span class="dt">FUN=</span>boundary_layer_resistance, <span class="dt">e_s=</span><span class="fl">2.4</span>, <span class="dt">e_a=</span><span class="fl">2.5</span>, <span class="dt">elev=</span><span class="dv">500</span>, <span class="dt">D=</span><span class="fl">0.007</span>, <span class="dt">u=</span><span class="dv">2</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">293</span><span class="op">:</span><span class="dv">313</span>, blr.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"air temperature (K)"</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"boundary layer resistance"</span> <span class="op">~</span><span class="st"> </span>(s <span class="op">~</span><span class="st"> </span>cm<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})))</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-30-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">blr.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="dv">5</span><span class="op">:</span><span class="dv">20</span>), <span class="dt">FUN=</span>boundary_layer_resistance, <span class="dt">T_a=</span><span class="dv">293</span>, <span class="dt">e_s=</span><span class="fl">2.4</span>, <span class="dt">e_a=</span><span class="fl">2.5</span>, <span class="dt">elev=</span><span class="dv">500</span>, <span class="dt">u=</span><span class="dv">2</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="dv">5</span><span class="op">:</span><span class="dv">20</span>), blr.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"diameter (m)"</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"boundary layer resistance"</span> <span class="op">~</span><span class="st"> </span>(s <span class="op">~</span><span class="st"> </span>cm<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})))</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-30-2.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#APPROXIMATELY CHECKED</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.seq=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">FUN=</span>Tb_salamander_humid, <span class="dt">r_i=</span><span class="dv">4</span>,<span class="dt">r_b=</span><span class="dv">1</span>,<span class="dt">D=</span><span class="fl">0.01</span>,<span class="dt">elev=</span><span class="dv">500</span>,<span class="dt">e_a=</span><span class="fl">2.5</span>,<span class="dt">e_s=</span><span class="fl">2.3</span>,<span class="dt">Qabs=</span><span class="dv">400</span>, <span class="dt">epsilon=</span><span class="fl">0.96</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, t.seq, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"ambient temperature (°C)"</span>, <span class="dt">ylab =</span> <span class="st">"humid operative temperature (°C)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">a=</span><span class="dv">0</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-31-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#CHECK WITH ERIC?</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="kw"><a href="../reference/Qthermal_radiation_absorbed.html">Qthermal_radiation_absorbed</a></span>(<span class="dt">T_a=</span><span class="dv">20</span><span class="op">:</span><span class="dv">40</span>, <span class="dt">T_g=</span><span class="dv">30</span>, <span class="dt">epsilon_ground=</span><span class="fl">0.97</span>, <span class="dt">a_longwave=</span><span class="fl">0.965</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"air temperature (°C)"</span>, <span class="dt">ylab =</span> <span class="st">"thermal radiation absorbed (W)"</span>)</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-32-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Qemitted_thermal_radiation.html">Qemitted_thermal_radiation</a></span>(<span class="dt">epsilon=</span><span class="fl">0.96</span>, <span class="dt">A=</span><span class="dv">1</span>, <span class="dt">psa_dir=</span><span class="fl">0.4</span>, <span class="dt">psa_ref=</span><span class="fl">0.6</span>, <span class="dt">T_b=</span><span class="dv">303</span>, <span class="dt">T_g=</span><span class="dv">293</span>, <span class="dt">T_a=</span><span class="dv">298</span>, <span class="dt">enclosed=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## [1] 78.35451</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#CHECK WITH ERIC?</span></code></pre></div>
</div>
<div id="tsoil-var" class="section level2">
<h2 class="hasAnchor">
<a href="#tsoil-var" class="anchor"></a>Tsoil var</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="kw"><a href="../reference/Tsoil.html">Tsoil</a></span>(<span class="dt">Tg_max=</span><span class="dv">30</span>, <span class="dt">Tg_min=</span><span class="dv">15</span>, <span class="dt">hour=</span><span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">depth=</span><span class="dv">0</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"hour"</span>, <span class="dt">ylab =</span> <span class="st">"soil temperature (°C)"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="kw"><a href="../reference/Tsoil.html">Tsoil</a></span>(<span class="dt">Tg_max=</span><span class="dv">30</span>, <span class="dt">Tg_min=</span><span class="dv">15</span>, <span class="dt">hour=</span><span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">depth=</span><span class="dv">5</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="kw"><a href="../reference/Tsoil.html">Tsoil</a></span>(<span class="dt">Tg_max=</span><span class="dv">30</span>, <span class="dt">Tg_min=</span><span class="dv">15</span>, <span class="dt">hour=</span><span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">depth=</span><span class="dv">10</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="kw"><a href="../reference/Tsoil.html">Tsoil</a></span>(<span class="dt">Tg_max=</span><span class="dv">30</span>, <span class="dt">Tg_min=</span><span class="dv">15</span>, <span class="dt">hour=</span><span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">depth=</span><span class="dv">20</span>), <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>,<span class="dt">title=</span><span class="st">"depth (cm)"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dashed"</span>,<span class="st">"dotted"</span>,<span class="st">"dotdash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-33-1.png" width="768"></p>
</div>
<div id="frog" class="section level2">
<h2 class="hasAnchor">
<a href="#frog" class="anchor"></a>Frog</h2>
<p>Spotila?</p>
</div>
</div>
<div id="example-operative-environmental-temperature-calculations" class="section level1">
<h1 class="hasAnchor">
<a href="#example-operative-environmental-temperature-calculations" class="anchor"></a>Example operative environmental temperature calculations</h1>
<p>Suppose we want to estimate the hourly body temperature (operative environmental temperature, <span class="math inline">\(T_e\)</span>) of a <em>Sceloporus</em> lizard on June 1, 2018 in Santa Fe, New Mexico, USA (35.69, -105.944, elevation: 2121m). Let’s assume the lizard is in an unshaded location where the daily air temperature varies from a minimum of 10°C to a maximum of 25°C, the soil surface temperature varies from a minimum of 15C to a maximum of 30°C, and the windspeed is 0.5 m/s. We assume that atmospheric transmissivity <span class="math inline">\(\tau=0.7\)</span> and albedo <span class="math inline">\(\rho=0.6\)</span>.</p>
<p>We will initially estimate <span class="math inline">\(T_b\)</span> by balancing an energy balance for steady state conditions. We then use the <span class="math inline">\(T_b\)</span> estimates to explore the components of an energy balance.</p>
<div id="environmental-data" class="section level2">
<h2 class="hasAnchor">
<a href="#environmental-data" class="anchor"></a>Environmental data</h2>
<p>Let us first prepare the environmental data for analysis. We will need to estimate hourly air and soil temperatures and radiation. We start by estimating day of year and the timing of sunrise and sunset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#set up input data as variables</span>
lat=<span class="fl">35.69</span>; lon=<span class="st"> </span><span class="op">-</span><span class="fl">105.944</span>; elev=<span class="dv">2121</span>
Tmin=<span class="dv">10</span>; Tmax=<span class="dv">25</span>; Tmin_s=<span class="dv">15</span>; Tmax_s=<span class="dv">30</span>
V=<span class="fl">0.5</span> <span class="co">#wind speed</span>
<span class="co">#assumptions</span>
tau=<span class="fl">0.7</span>; rho=<span class="fl">0.6</span>

doy=<span class="st"> </span><span class="kw"><a href="../reference/day_of_year.html">day_of_year</a></span>(<span class="st">"2018-06-01"</span>, <span class="dt">format=</span> <span class="st">"%Y-%m-%d"</span>)
snoon=<span class="st"> </span><span class="kw"><a href="../reference/solar_noon.html">solar_noon</a></span>(<span class="dt">lon=</span>lon, <span class="dt">doy=</span>doy)
dayl=<span class="st"> </span><span class="kw"><a href="../reference/daylength.html">daylength</a></span>(<span class="dt">lat=</span>lat, <span class="dt">doy=</span>doy)
tr=<span class="st"> </span>snoon<span class="op">-</span>dayl<span class="op">/</span><span class="dv">2</span>
ts=<span class="st"> </span>snoon<span class="op">+</span>dayl<span class="op">/</span><span class="dv">2</span></code></pre></div>
<p>We can estimate hourly solar radiation as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psi_deg=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">FUN=</span>zenith_angle, <span class="dt">doy=</span>doy, <span class="dt">lat=</span>lat, <span class="dt">lon=</span>lon)
psi_rad=<span class="st"> </span><span class="kw"><a href="../reference/degree_to_radian.html">degree_to_radian</a></span>(psi_deg) <span class="co">#convert to radians</span>
Srad=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(psi_rad, <span class="dt">FUN=</span>estimate_radiation, <span class="dt">doy=</span>doy, <span class="dt">tau=</span>tau, <span class="dt">elev=</span>elev, <span class="dt">rho=</span>rho)
<span class="co">#Separate into direct, diffuse, and reflected solar radiation</span>
 Sdir=<span class="st"> </span>Srad[<span class="dv">1</span>,]
 Sdif=<span class="st"> </span>Srad[<span class="dv">2</span>,]
 Sref=<span class="st"> </span>Srad[<span class="dv">3</span>,]
 
<span class="co">#Plot </span>
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Sdir, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"hour"</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(radiation <span class="op">~</span><span class="st"> </span>(W<span class="op">/</span>m<span class="op">^</span>{<span class="dv">2</span>})), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">1200</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Sdif, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Sref, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="dt">title=</span><span class="st">"Solar radiation component"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"direct"</span>, <span class="st">"diffuse"</span>, <span class="st">"reflected"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dotted"</span>,<span class="st">"dashed"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-35-1.png" width="768"></p>
<p>We can then calculate hourly air and soil temperatures. We use the sine-exponential model for air temperature and the sine model for surface temperature:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ta=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, diurnal_temp_variation_sineexp, <span class="dt">T_max=</span>Tmax, <span class="dt">T_min=</span>Tmin, <span class="dt">t_r=</span>tr, <span class="dt">t_s=</span>ts, <span class="dt">alpha=</span><span class="fl">2.59</span>, <span class="dt">beta=</span> <span class="fl">1.55</span>, <span class="dt">gamma=</span><span class="fl">2.2</span>)
Ts=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, diurnal_temp_variation_sine, <span class="dt">T_max=</span>Tmax_s, <span class="dt">T_min=</span>Tmin_s)</code></pre></div>
</div>
<div id="operative-temperature-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#operative-temperature-estimation" class="anchor"></a>Operative temperature estimation</h2>
<p>We will first use functions based on energy balances to estimate body temperature given the environmental conditions. We first need to estimate several energy balance parameters. We first estimate the surface area exposed to radation We model a 10g <em>Sceloporus</em> lizard with solar aborptivity <span class="math inline">\(a=0.9\)</span> <span class="citation">(Gates 2012)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mass=<span class="dv">10</span>
a=<span class="fl">0.9</span> <span class="co">#solar absorptivity</span>

<span class="co">#estimate surface area (m^2) from mass (g)</span>
A=<span class="st"> </span><span class="kw"><a href="../reference/sa_from_mass.html">sa_from_mass</a></span>(mass, <span class="st">"lizard"</span>)
<span class="co">#estimate projected (silhouette) area as a portion of surface area</span>
psa=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(psi_deg, prop_silhouette_area, <span class="dt">taxa=</span> <span class="st">"lizard"</span>, <span class="dt">posture=</span> <span class="st">"elevated"</span>)
<span class="co">#change negative values to zero</span>
psa[psa<span class="op">&lt;</span><span class="dv">0</span>]=<span class="dv">0</span>

<span class="co">#Total radiation </span>
Qabs=<span class="st"> </span>psa<span class="op">*</span>Sdir <span class="op">+</span><span class="fl">0.5</span><span class="op">*</span>Sdif <span class="op">+</span><span class="fl">0.5</span><span class="op">*</span>Sref</code></pre></div>
<p>We then estimate the lizard’s heat transfer coefficient, <span class="math inline">\(H_L\)</span> using an empirical relationship for lizards (<code><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient()</a></code>), but also illustrate a function estimating <span class="math inline">\(H_L\)</span> using a spherical approximation (<code><a href="../reference/heat_transfer_coefficient_approximation.html">heat_transfer_coefficient_approximation()</a></code>) and a simplified approximation (<code><a href="../reference/heat_transfer_coefficient_simple.html">heat_transfer_coefficient_simple()</a></code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Use DRYAIR in NicheMapR to estimate thermal conductivity of air and kinematic viscocity</span>
<span class="co">#library(NicheMapR)</span>

<span class="co">#estimate Barometric pressure (pascal)</span>
ap=<span class="st"> </span><span class="kw"><a href="../reference/airpressure_from_elev.html">airpressure_from_elev</a></span>(elev)<span class="op">*</span><span class="dv">1000</span>
  
DRYAIRout=<span class="st"> </span><span class="kw"><a href="../reference/DRYAIR.html">DRYAIR</a></span>(<span class="dt">db=</span>Ta, <span class="dt">bp=</span>ap, <span class="dt">alt=</span>elev)
K=<span class="st"> </span>DRYAIRout<span class="op">$</span>thcond
nu=<span class="st"> </span>DRYAIRout<span class="op">$</span>viskin <span class="co">#Kinematic viscosity (m2 s-1)</span>

svl=<span class="fl">0.06</span> <span class="co">#SVL for Sceloporus</span>

<span class="co">#We will use the average of K and nu across the day for simplicity and since there's not substantial variation</span>
K=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(K)
nu=<span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(nu)

<span class="co">#Estimate using empirical relationship</span>
H_L=<span class="kw"><a href="../reference/heat_transfer_coefficient.html">heat_transfer_coefficient</a></span>(<span class="dt">V=</span>V,<span class="dt">D=</span>svl,<span class="dt">K=</span>K, <span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>) , <span class="dt">taxa=</span><span class="st">"lizard_surface"</span>)

<span class="co">#Also illustrate estimations using a spherical approximation and a simplified version of the approximation.</span>
<span class="kw"><a href="../reference/heat_transfer_coefficient_approximation.html">heat_transfer_coefficient_approximation</a></span>(<span class="dt">V=</span>V,<span class="dt">D=</span>svl,<span class="dt">K=</span> K, <span class="dt">nu=</span> <span class="fl">15.3</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>), <span class="dt">taxa=</span><span class="st">"lizard"</span>)</code></pre></div>
<pre><code>## [1] 22.49314</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/heat_transfer_coefficient_simple.html">heat_transfer_coefficient_simple</a></span>(<span class="dt">V=</span><span class="fl">0.5</span>,<span class="dt">D=</span><span class="fl">0.05</span>)</code></pre></div>
<pre><code>## [1] 14.80412</code></pre>
<p>We now implement the first energy balance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TeGates=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, <span class="dv">24</span>)
<span class="cf">for</span>(hr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) TeGates[hr]=<span class="st"> </span><span class="kw"><a href="../reference/Tb_Gates.html">Tb_Gates</a></span>(<span class="dt">A=</span>A, <span class="dt">D=</span>svl<span class="op">/</span><span class="dv">3</span>, <span class="dt">psa_dir=</span>psa[hr], <span class="dt">psa_ref=</span><span class="fl">0.5</span>, <span class="dt">psa_air=</span><span class="fl">0.5</span>, <span class="dt">psa_g=</span><span class="fl">0.05</span>, <span class="dt">T_g=</span>Ts[hr]<span class="op">+</span><span class="dv">273</span>, <span class="dt">T_a=</span>Ta[hr]<span class="op">+</span><span class="dv">273</span>, <span class="dt">Qabs=</span>Qabs[hr]<span class="op">*</span>A, <span class="dt">epsilon=</span>epsilon_s, <span class="dt">H_L=</span>H_L, <span class="dt">ef=</span><span class="fl">1.3</span>, <span class="dt">K=</span><span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."
## [1] "Unable to balance energy budget. One issue to check is whether absorbed solar radiation exceeds energy potentially lost to thermal radiation, convection, and conduction."</code></pre>
<p>We also implement a similiar but simplied energy balance. The energy balance omits conduction with the ground and thus underestimates temperatures, but we implement it for comparison purposes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epsilon_s=<span class="fl">0.965</span>

TeCN=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, <span class="dv">24</span>)
<span class="cf">for</span>(hr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) TeCN[hr]=<span class="st"> </span><span class="kw"><a href="../reference/Tb_CampbellNorman.html">Tb_CampbellNorman</a></span>(<span class="dt">T_a=</span>Ta[hr]<span class="op">+</span><span class="dv">273</span>, <span class="dt">S=</span>Qabs[hr], <span class="dt">epsilon=</span>epsilon_s, <span class="dt">c_p=</span><span class="fl">29.3</span>, <span class="dt">D=</span>svl, <span class="dt">V=</span>V)</code></pre></div>
<p>We additionally estimate <span class="math inline">\(Te\)</span> using the specialized function for lizards:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TeLiz=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, <span class="dv">24</span>)
<span class="cf">for</span>(hr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) TeLiz[hr]=<span class="st"> </span><span class="kw"><a href="../reference/Tb_lizard.html">Tb_lizard</a></span>(<span class="dt">T_a=</span>Ta[hr], <span class="dt">T_g=</span>Ts[hr], <span class="dt">u=</span>V, <span class="dt">svl=</span>svl<span class="op">*</span><span class="dv">1000</span>, <span class="dt">m=</span>mass, <span class="dt">psi=</span>psi_deg[hr], <span class="dt">rho_S=</span>rho, <span class="dt">elev=</span>elev, <span class="dt">doy=</span>doy, <span class="dt">sun=</span><span class="ot">TRUE</span>, <span class="dt">surface=</span><span class="ot">TRUE</span>, <span class="dt">alpha_S=</span>a, <span class="dt">alpha_L=</span><span class="fl">0.965</span>, <span class="dt">epsilon_s=</span>epsilon_s, <span class="dt">F_d=</span><span class="fl">0.8</span>, <span class="dt">F_r=</span><span class="fl">0.5</span>, <span class="dt">F_a=</span><span class="fl">0.5</span>, <span class="dt">F_g=</span><span class="fl">0.5</span>)

TeFei=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, <span class="dv">24</span>)
<span class="cf">for</span>(hr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) TeFei[hr]=<span class="st"> </span><span class="kw"><a href="../reference/Tb_Fei.html">Tb_Fei</a></span>(<span class="dt">T_a=</span>Ta[hr]<span class="op">+</span><span class="dv">273</span>, <span class="dt">T_g=</span>Ts[hr]<span class="op">+</span><span class="dv">273</span>, <span class="dt">H=</span>Qabs[hr], <span class="dt">lw=</span><span class="dv">30</span>, <span class="dt">shade=</span><span class="fl">0.5</span>, <span class="dt">m=</span><span class="fl">10.5</span>, <span class="dt">Acondfact=</span><span class="fl">0.05</span>, <span class="dt">Agradfact=</span><span class="fl">0.4</span>)</code></pre></div>
<p>We next plot the diurnal trends in environmental data and the operative data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>), <span class="dt">mgp=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">las=</span><span class="dv">0</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, TeGates<span class="op">-</span><span class="dv">273</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab=</span><span class="st">"Hour"</span>, <span class="dt">ylab=</span><span class="st">"Temperature (°C)"</span>, <span class="dt">col=</span><span class="st">"blue"</span>, <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">80</span>)) <span class="co">#Gates</span>
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, TeCN<span class="op">-</span><span class="dv">273</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">col=</span><span class="st">"blue"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>) <span class="co">#Campbell</span>
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, TeLiz, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">col=</span><span class="st">"blue"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>) <span class="co">#Buckley 2008</span>
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, TeFei<span class="op">-</span><span class="dv">273</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">col=</span><span class="st">"blue"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>) <span class="co">#Fei et al.</span>
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Ta, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">col=</span><span class="st">"orange"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Ts, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">col=</span><span class="st">"purple"</span>)
 
<span class="co"># #add additional axis with radiation</span>
<span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">new =</span> T)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Sdir, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">axes=</span>F, <span class="dt">xlab=</span><span class="ot">NA</span>, <span class="dt">ylab=</span><span class="ot">NA</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">col=</span><span class="st">"green"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dt">side =</span> <span class="dv">4</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="st">'Radiation'</span>, <span class="dt">col=</span><span class="st">"green"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>,
        <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Ta"</span>, <span class="st">"Ts"</span>, <span class="st">"Tb_Gates"</span>, <span class="st">"Tb_CampbellNorman"</span>, <span class="st">"Tb_lizard"</span>, <span class="st">"Tb_Fei"</span>),
        <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>, <span class="st">"solid"</span>,<span class="st">"dotted"</span>,<span class="st">"dashed"</span>,<span class="st">"dotdash"</span>), <span class="dt">pch=</span><span class="ot">NA</span>, <span class="dt">col=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"orange"</span>, <span class="st">"purple"</span>, <span class="st">"blue"</span>,<span class="st">"blue"</span>,<span class="st">"blue"</span>,<span class="st">"blue"</span>))</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-42-1.png" width="768"></p>
</div>
<div id="energy-balance" class="section level2">
<h2 class="hasAnchor">
<a href="#energy-balance" class="anchor"></a>Energy balance</h2>
<p>We will now use the body temperature estimates to examine the components of the energy balance. We will be solving the following energy balance: <span class="math display">\[Qnet = Qabs - Qemit - Qconv - Qcond + Qmet - Qevap,\]</span> We will estimate each term on the right side of the equation in turn.</p>
<p>We calculate the hourly radiation asborbed as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Qabs=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, <span class="dv">24</span>)
<span class="cf">for</span>(hr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) Qabs[hr]=<span class="st"> </span><span class="kw"><a href="../reference/Qradiation_absorbed.html">Qradiation_absorbed</a></span>(<span class="dt">a=</span>a, <span class="dt">A=</span>A, <span class="dt">psa_dir=</span>psa[hr], <span class="dt">psa_ref=</span><span class="dv">1</span><span class="op">-</span>psa[hr], <span class="dt">S_dir=</span>Sdir[hr], <span class="dt">S_dif=</span>Sdif[hr], <span class="dt">a_s=</span>rho)</code></pre></div>
<p>We estimate thermal radiation <span class="math inline">\(Q_{emit}\)</span> for the lizard outdoors. We assume the surface emisivity of lizards, <span class="math inline">\(epsilon_s=0.965\)</span> [Bartlett &amp; Gates 1967].</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Use Gates model as Te estimate</span>
Te=<span class="st"> </span>TeGates<span class="op">-</span><span class="dv">273</span>

Qemit=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, <span class="dv">24</span>)
<span class="cf">for</span>(hr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) Qemit[hr]=<span class="kw"><a href="../reference/Qemitted_thermal_radiation.html">Qemitted_thermal_radiation</a></span>(<span class="dt">epsilon=</span>epsilon_s, <span class="dt">A=</span>A, <span class="dt">psa_dir=</span>psa[hr], <span class="dt">psa_ref=</span><span class="dv">1</span><span class="op">-</span>psa[hr], <span class="dt">T_b=</span>Te[hr]<span class="op">+</span><span class="dv">273</span>, <span class="dt">T_g=</span>Ts[hr]<span class="op">+</span><span class="dv">273</span>, <span class="dt">T_a=</span>Ta[hr]<span class="op">+</span><span class="dv">273</span>, <span class="dt">enclosed=</span><span class="ot">FALSE</span>)</code></pre></div>
<p>We next estimate convection <span class="math inline">\(Q_{conv}\)</span> and conduction <span class="math inline">\(Q_{cond}\)</span>. We estimate convective heat exchange between the animal and surrounding air using the following relationship: <span class="math display">\[Qconv= ef*H_L*(A*proportion)*(Ta-Tb),\]</span> where an enhancement factor, <span class="math inline">\(ef\)</span>, multiplier can be incorported to account for increases in heat exchange resulting from air turbulance in field conditions.</p>
<p>The function is available in R assuming that 2/3 of the lizard’s surface area is exchanging heat through convection.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Qconv=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, <span class="dv">24</span>)
<span class="cf">for</span>(hr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) Qconv[hr]=<span class="st"> </span><span class="kw"><a href="../reference/Qconvection.html">Qconvection</a></span>(<span class="dt">T_a=</span> Ta[hr]<span class="op">+</span><span class="dv">273</span>,<span class="dt">T_b=</span> Te[hr]<span class="op">+</span><span class="dv">273</span>,<span class="dt">H=</span>H_L,<span class="dt">A=</span>A, <span class="dt">proportion=</span><span class="fl">0.67</span>, <span class="dt">ef=</span><span class="fl">1.3</span>)</code></pre></div>
<p>We estimate conductance between the lizard and surface assuming conductance through the animal tissue is the rate limiting step as follows: <span class="math display">\[Qcond= A*proportion*K*(T_g-T_b)/d, \]</span> We conduct the estimate in R assuming that 1/3 of the lizard surface is in contact with the ground and a skin thinkness of <span class="math inline">\(10^{-6}\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Qcond=<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, <span class="dv">24</span>)
<span class="cf">for</span>(hr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) Qcond[hr]=<span class="kw"><a href="../reference/Qconduction_animal.html">Qconduction_animal</a></span>(<span class="dt">T_g=</span> Ts[hr]<span class="op">+</span><span class="dv">273</span>,<span class="dt">T_b=</span>Te[hr]<span class="op">+</span><span class="dv">273</span>,<span class="dt">d=</span>svl<span class="op">/</span><span class="dv">3</span>,<span class="dt">K=</span><span class="fl">0.5</span>,<span class="dt">A=</span>A, <span class="dt">proportion=</span><span class="fl">0.05</span>)</code></pre></div>
<p>We assume, as in generally done for lizards, that heat exchange associated with metabolism and evaporation is negliglible:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Qmet=<span class="st"> </span><span class="dv">0</span>
Qevap=<span class="st"> </span><span class="dv">0</span></code></pre></div>
<p>The full heat budget can be calculated as follows. We plot out the energy balance components.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Qnet=<span class="st"> </span><span class="kw"><a href="../reference/Qnet_Gates.html">Qnet_Gates</a></span>(<span class="dt">Qabs=</span>Qabs, <span class="dt">Qemit=</span>Qemit, <span class="dt">Qconv=</span>Qconv, <span class="dt">Qcond=</span>Qcond, <span class="dt">Qmet=</span>Qmet, <span class="dt">Qevap=</span>Qevap)

<span class="co">#Plot </span>
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Qnet, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">"hour"</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"heat flux"</span> <span class="op">~</span><span class="st"> </span>(W<span class="op">/</span>m<span class="op">^</span>{<span class="dv">2</span>})), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">4</span>))
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Qabs, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotted"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Qemit, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dashed"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Qconv, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"dotdash"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, Qcond, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="st">"twodash"</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="dt">title=</span><span class="st">"component"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"net radition, Qnet"</span>, <span class="st">"solar radiation, Qabs"</span>, <span class="st">"thermal radiation, Qemit"</span>,<span class="st">"convection, Qconv"</span>,<span class="st">"conduction, Qcond"</span>), <span class="dt">lty=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"solid"</span>,<span class="st">"dotted"</span>,<span class="st">"dashed"</span>,<span class="st">"dotdash"</span>,<span class="st">"twodash"</span>) )</code></pre></div>
<p><img src="TeTutorial_files/figure-html/unnamed-chunk-48-1.png" width="768"></p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-anderson1979habitat">
<p>Anderson, RV, CR Tracy, and Z Abramsky. 1979. “Habitat Selection in Two Species of Short-Horned Grasshoppers.” <em>Oecologia</em> 38 (3). Springer: 359–74.</p>
</div>
<div id="ref-bakken1992measurement">
<p>Bakken, George S. 1992. “Measurement and Application of Operative and Standard Operative Temperatures in Ecology.” <em>American Zoologist</em> 32 (2). Oxford University Press UK: 194–216.</p>
</div>
<div id="ref-barlett1967energy">
<p>Barlett, Peter N, and David M Gates. 1967. “The Energy Budget of a Lizard on a Tree Trunk.” <em>Ecology</em> 48 (2). Wiley Online Library: 315–22.</p>
</div>
<div id="ref-buckley2007linking">
<p>Buckley, Lauren B. 2007. “Linking Traits to Energetics and Population Dynamics to Predict Lizard Ranges in Changing Environments.” <em>The American Naturalist</em> 171 (1). The University of Chicago Press: E1–E19.</p>
</div>
<div id="ref-buckley2012demographic">
<p>Buckley, Lauren B, and Joel G Kingsolver. 2012. “The Demographic Impacts of Shifts in Climate Means and Extremes on Alpine Butterflies.” <em>Functional Ecology</em> 26 (4). Wiley Online Library: 969–77.</p>
</div>
<div id="ref-buckley2014phenotypic">
<p>Buckley, Lauren B, Cesar R Nufio, and Joel G Kingsolver. 2014. “Phenotypic Clines, Energy Balances and Ecological Responses to Climate Change.” <em>Journal of Animal Ecology</em> 83 (1). Wiley Online Library: 41–50.</p>
</div>
<div id="ref-campbell2012introduction">
<p>Campbell, Gaylon S, and John Norman. 2012. <em>An Introduction to Environmental Biophysics</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-erbs1982estimation">
<p>Erbs, DG, SA Klein, and JA Duffie. 1982. “Estimation of the Diffuse Radiation Fraction for Hourly, Daily and Monthly-Average Global Radiation.” <em>Solar Energy</em> 28 (4). Elsevier: 293–302.</p>
</div>
<div id="ref-forsythe1995model">
<p>Forsythe, William C, Edward J Rykiel Jr, Randal S Stahl, Hsin-i Wu, and Robert M Schoolfield. 1995. “A Model Comparison for Daylength as a Function of Latitude and Day of Year.” <em>Ecological Modelling</em> 80 (1). Elsevier: 87–95.</p>
</div>
<div id="ref-galushko2005electrical">
<p>Galushko, D, N Ermakov, M Karpovski, A Palevski, JS Ishay, and DJ Bergman. 2005. “Electrical, Thermoelectric and Thermophysical Properties of Hornet Cuticle.” <em>Semiconductor Science and Technology</em> 20 (3). IOP Publishing: 286.</p>
</div>
<div id="ref-gates2012biophysical">
<p>Gates, David M. 2012. <em>Biophysical Ecology</em>. Courier Corporation.</p>
</div>
<div id="ref-gillooly2001effects">
<p>Gillooly, James F, James H Brown, Geoffrey B West, Van M Savage, and Eric L Charnov. 2001. “Effects of Size and Temperature on Metabolic Rate.” <em>Science</em> 293 (5538). American Association for the Advancement of Science: 2248–51.</p>
</div>
<div id="ref-kingsolver1983thermoregulation">
<p>Kingsolver, Joel G. 1983. “Thermoregulation and Flight in Colias Butterflies: Elevational Patterns and Mechanistic Limitations.” <em>Ecology</em> 64 (3). Wiley Online Library: 534–45.</p>
</div>
<div id="ref-lactin1998environmental">
<p>Lactin, Derek J, and Dan L Johnson. 1998. “Environmental, Physical, and Behavioural Determinants of Body Temperature in Grasshopper Nymphs (Orthoptera: Acrididae).” <em>The Canadian Entomologist</em> 130 (5). Cambridge University Press: 551–77.</p>
</div>
<div id="ref-mitchell1976heat">
<p>Mitchell, John W. 1976. “Heat Transfer from Spheres and Other Animal Forms.” <em>Biophysical Journal</em> 16 (6). Cell Press: 561–69.</p>
</div>
<div id="ref-muth1977thermoregulatory">
<p>Muth, Allan. 1977. “Thermoregulatory Postures and Orientation to the Sun: A Mechanistic Evaluation for the Zebra-Tailed Lizard, Callisaurus Draconoides.” <em>Copeia</em>. JSTOR, 710–20.</p>
</div>
<div id="ref-norris1967color">
<p>Norris, Kenneth S. 1967. “Color Adaptation in Desert Reptiles and Its Thermal Relationships.” In <em>Lizard Ecology: A Symposium</em>, 162–229. University of Missouri Press Columbia.</p>
</div>
<div id="ref-porter1979behavioral">
<p>Porter, WP, and FC James. 1979. “Behavioral Implications of Mechanistic Ecology Ii: The African Rainbow Lizard, Agama Agama.” <em>Copeia</em>. JSTOR, 594–619.</p>
</div>
<div id="ref-porter1973behavioral">
<p>Porter, WP, JW Mitchell, WA Beckman, and CB DeWitt. 1973. “Behavioral Implications of Mechanistic Ecology.” <em>Oecologia</em> 13 (1). Springer: 1–54.</p>
</div>
<div id="ref-roughgarden1981resource">
<p>Roughgarden, Jonathan, Warren Porter, and David Heckel. 1981. “Resource Partitioning of Space and Its Relationship to Body Temperature in Anolis Lizard Populations.” <em>Oecologia</em> 50 (2). Springer: 256–64.</p>
</div>
<div id="ref-samietz2005altitudinal">
<p>Samietz, J, MA Salser, and H Dingle. 2005. “Altitudinal Variation in Behavioural Thermoregulation: Local Adaptation Vs. Plasticity in California Grasshoppers.” <em>Journal of Evolutionary Biology</em> 18 (4). Wiley Online Library: 1087–96.</p>
</div>
<div id="ref-spotila1992biophysics">
<p>Spotila, JR, MP O’connor, and GS Bakken. 1992. “Biophysics of Heat and Mass Transfer.” <em>Environmental Physiology of the Amphibians. University of Chicago Press, Chicago</em>, 59–80.</p>
</div>
<div id="ref-swinbank1963long">
<p>Swinbank, W CQJR. 1963. “Long-Wave Radiation from Clear Skies.” <em>Quarterly Journal of the Royal Meteorological Society</em> 89 (381). Wiley Online Library: 339–48.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#operative-environmental-temperatures">Operative environmental temperatures</a></li>
      <li><a href="#solar-radiation-qabs">Solar radiation, Qabs</a></li>
      <li><a href="#thermal-radiation-qemit">Thermal radiation, Qemit</a></li>
      <li><a href="#convection-qconv">Convection, Qconv</a></li>
      <li><a href="#conduction-qcond">Conduction, Qcond</a></li>
      <li><a href="#metabolism-qmet">Metabolism, Qmet</a></li>
      <li><a href="#evaporation-qevap">Evaporation, Qevap</a></li>
      <li>
<a href="#solving-for-operative-environmental-temperature-te">Solving for operative environmental temperature, Te</a><ul class="nav nav-pills nav-stacked">
<li><a href="#fei">Fei</a></li>
      </ul>
</li>
      <li>
<a href="#specialized-energy-balance-models-and-functions">Specialized energy balance models and functions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#lizards">Lizards</a></li>
      <li><a href="#butterflies">Butterflies</a></li>
      <li><a href="#grasshoppers">Grasshoppers</a></li>
      <li><a href="#salamander">Salamander</a></li>
      <li><a href="#tsoil-var">Tsoil var</a></li>
      <li><a href="#frog">Frog</a></li>
      </ul>
</li>
      <li>
<a href="#example-operative-environmental-temperature-calculations">Example operative environmental temperature calculations</a><ul class="nav nav-pills nav-stacked">
<li><a href="#environmental-data">Environmental data</a></li>
      <li><a href="#operative-temperature-estimation">Operative temperature estimation</a></li>
      <li><a href="#energy-balance">Energy balance</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lauren Buckley, Aji John, Bryan Briones Ortiz, Yutaro Sakairi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
